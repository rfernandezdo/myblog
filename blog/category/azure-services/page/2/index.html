
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="A blog about Azure, DevOps and other stuff" name="description"/>
<meta content="Rafael FernÃ¡ndez" name="author"/>
<link href="https://rfernandezdo.github.io/blog/category/azure-services/page/2/" rel="canonical"/>
<link href="../../../azure-frameworks/" rel="prev"/>
<link href="../../../azure-updates/" rel="next"/>
<link href="../../../../../feed_rss_created.xml" rel="alternate" title="RSS feed" type="application/rss+xml"/>
<link href="../../../../../feed_rss_updated.xml" rel="alternate" title="RSS feed of updated content" type="application/rss+xml"/>
<link href="../../../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.34" name="generator"/>
<title>Azure Services - Un Rinconcito donde contar lo que quiera</title>
<link href="../../../../../assets/stylesheets/main.35f28582.min.css" rel="stylesheet"/>
<link href="../../../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<meta content="website" property="og:type"/>
<meta content="Azure Services - Un Rinconcito donde contar lo que quiera" property="og:title"/>
<meta content="A blog about Azure, DevOps and other stuff" property="og:description"/>
<meta content="https://rfernandezdo.github.io/assets/images/social/blog/category/azure-services/page/2.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="1200" property="og:image:width"/>
<meta content="630" property="og:image:height"/>
<meta content="https://rfernandezdo.github.io/blog/category/azure-services/page/2/" property="og:url"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="Azure Services - Un Rinconcito donde contar lo que quiera" name="twitter:title"/>
<meta content="A blog about Azure, DevOps and other stuff" name="twitter:description"/>
<meta content="https://rfernandezdo.github.io/assets/images/social/blog/category/azure-services/page/2.png" name="twitter:image"/>
 <link href="../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="blue" data-md-color-primary="blue" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#azure-services">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Un Rinconcito donde contar lo que quiera" class="md-header__button md-logo" data-md-component="logo" href="../../../../.." title="Un Rinconcito donde contar lo que quiera">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Un Rinconcito donde contar lo que quiera
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Azure Services
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="blue" data-md-color-media="" data-md-color-primary="blue" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="blue" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<div class="md-header__option">
<div class="md-select">
<button aria-label="Select language" class="md-header__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"></path></svg>
</button>
<div class="md-select__inner">
<ul class="md-select__list">
<li class="md-select__item">
<a class="md-select__link" href="https://rfernandezdo-github-io.translate.goog/?_x_tr_sl=auto&amp;_x_tr_tl=es&amp;_x_tr_hl=es&amp;_x_tr_pto=wapp" hreflang="en">
              English
            </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="https://rfernandezdo-github-io.translate.goog/?_x_tr_sl=auto&amp;_x_tr_tl=en&amp;_x_tr_hl=en&amp;_x_tr_pto=wapp" hreflang="es">
              Spanish
            </a>
</li>
</ul>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../../../">
          
  
  Blog

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../..">
        
  
    
  
  About

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../../contributions/">
        
  
    
  
  Contributions

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../../Azure/Security/MCSB/Readme/">
          
  
  Azure

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Un Rinconcito donde contar lo que quiera" class="md-nav__button md-logo" data-md-component="logo" href="../../../../.." title="Un Rinconcito donde contar lo que quiera">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Un Rinconcito donde contar lo que quiera
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
<span class="md-ellipsis">
    Blog
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Blog
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../">
<span class="md-ellipsis">
    Blog
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../tags/">
<span class="md-ellipsis">
    Posts by Tags
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="">
<span class="md-ellipsis">
    Archive
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
            Archive
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2025/01/">
<span class="md-ellipsis">
    2025/01
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2024/12/">
<span class="md-ellipsis">
    2024/12
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2024/11/">
<span class="md-ellipsis">
    2024/11
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2024/10/">
<span class="md-ellipsis">
    2024/10
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2024/09/">
<span class="md-ellipsis">
    2024/09
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2024/06/">
<span class="md-ellipsis">
    2024/06
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2024/05/">
<span class="md-ellipsis">
    2024/05
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2024/04/">
<span class="md-ellipsis">
    2024/04
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2024/03/">
<span class="md-ellipsis">
    2024/03
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2024/02/">
<span class="md-ellipsis">
    2024/02
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2023/12/">
<span class="md-ellipsis">
    2023/12
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2023/11/">
<span class="md-ellipsis">
    2023/11
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../2023/10/">
<span class="md-ellipsis">
    2023/10
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="">
<span class="md-ellipsis">
    Categories
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_1_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_4">
<span class="md-nav__icon md-icon"></span>
            Categories
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../azure/">
<span class="md-ellipsis">
    Azure
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../azure-frameworks/">
<span class="md-ellipsis">
    Azure Frameworks
  </span>
</a>
</li>
<li class="md-nav__item">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<a class="md-nav__link md-nav__link--active" href="../../">
<span class="md-ellipsis">
    Azure Services
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../azure-updates/">
<span class="md-ellipsis">
    Azure Updates
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../devops/">
<span class="md-ellipsis">
    DevOps
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../development/">
<span class="md-ellipsis">
    Development
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../english/">
<span class="md-ellipsis">
    English
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../finops/">
<span class="md-ellipsis">
    FinOps
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hashicorp/">
<span class="md-ellipsis">
    HashiCorp
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../hello_world/">
<span class="md-ellipsis">
    Hello_World
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../learning/">
<span class="md-ellipsis">
    Learning
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../m365/">
<span class="md-ellipsis">
    M365
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../microsoft-365/">
<span class="md-ellipsis">
    Microsoft 365
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../microsoft-entra/">
<span class="md-ellipsis">
    Microsoft Entra
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../microsoft-entra-external-id/">
<span class="md-ellipsis">
    Microsoft Entra External ID
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../microsoft-entra-id/">
<span class="md-ellipsis">
    Microsoft Entra ID
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../outlook/">
<span class="md-ellipsis">
    Outlook
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../power-bi/">
<span class="md-ellipsis">
    Power BI
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../security/">
<span class="md-ellipsis">
    Security
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../snowflake/">
<span class="md-ellipsis">
    Snowflake
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../tools/">
<span class="md-ellipsis">
    Tools
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../visual-studio-code/">
<span class="md-ellipsis">
    Visual Studio Code
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../windows/">
<span class="md-ellipsis">
    Windows
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../..">
<span class="md-ellipsis">
    About
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../contributions/">
<span class="md-ellipsis">
    Contributions
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Azure
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Azure
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
<span class="md-ellipsis">
    Security
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_1">
<span class="md-nav__icon md-icon"></span>
            Security
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
<span class="md-ellipsis">
    MCSB
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_1_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_4_1_1">
<span class="md-nav__icon md-icon"></span>
            MCSB
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Readme/">
<span class="md-ellipsis">
    MCSB_v1 - Readme
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Asset%20Management/">
<span class="md-ellipsis">
    MCSB_v1 - Asset Management
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Backup%20and%20Recovery/">
<span class="md-ellipsis">
    MCSB_v1 - Backup and Recovery
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Data%20Protection/">
<span class="md-ellipsis">
    MCSB_v1 - Data Protection
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/DevOps%20Security/">
<span class="md-ellipsis">
    MCSB_v1 - DevOps Security
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Endpoint%20Security/">
<span class="md-ellipsis">
    MCSB_v1 - Endpoint Security
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Governance%20and%20Strategy/">
<span class="md-ellipsis">
    MCSB_v1 - Governance and Strategy
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Identity%20Management/">
<span class="md-ellipsis">
    MCSB_v1 - Identity Management
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Incident%20Response/">
<span class="md-ellipsis">
    MCSB_v1 - Incident Response
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Logging%20and%20Threat%20Detection/">
<span class="md-ellipsis">
    MCSB_v1 - Logging and Threat Detection
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Network%20Security/">
<span class="md-ellipsis">
    MCSB_v1 - Network Security
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Posture%20and%20Vulnerability%20Mgmt/">
<span class="md-ellipsis">
    MCSB_v1 - Posture and Vulnerability Mgmt
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../../Azure/Security/MCSB/Privileged%20Access/">
<span class="md-ellipsis">
    MCSB_v1 - Privileged Access
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<div class="md-content__inner">
<header class="md-typeset">
<h1 id="azure-services">Azure Services</h1>
</header>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael FernÃ¡ndez" src="https://avatars.githubusercontent.com/u/39990341"/>
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-11 00:00:00">June 11, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../">Azure Services</a>, 
              <a class="md-meta__link" href="../../../power-bi/">Power BI</a></li>
<li class="md-meta__item">
            
              4 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway"><a class="toclink" href="../../../../2024/06/11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/">Securely connect Power BI to data sources with a VNet data gateway</a></h2>
<p>In this post, I will show you how to securely connect Power BI to your Azure data services using a Virtual Network (VNet) data gateway.</p>
<h3 id="what-is-a-virtual-network-vnet-data-gateway"><a class="toclink" href="../../../../2024/06/11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#what-is-a-virtual-network-vnet-data-gateway">What is a Virtual Network (VNet) data gateway?</a></h3>
<p>The virtual network (VNet) data gateway helps you to connect from Microsoft Cloud services to your Azure data services within a VNet without the need of an on-premises data gateway. The VNet data gateway securely communicates with the data source, executes queries, and transmits results back to the service.</p>
<h3 id="the-role-of-a-vnet-data-gateway"><a class="toclink" href="../../../../2024/06/11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#the-role-of-a-vnet-data-gateway">The Role of a VNet Data Gateway</a></h3>
<p>A VNet data gateway acts as a bridge that allows for the secure flow of data between the Power Platform and external data sources that reside within a virtual network. This includes services such as SQL databases, file storage solutions, and other cloud-based resources. The gateway ensures that data can be transferred securely and reliably, without exposing the network to potential threats or breaches.</p>
<h3 id="how-it-works"><a class="toclink" href="../../../../2024/06/11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#how-it-works">How It Works</a></h3>
<pre class="mermaid"><code>graph LR
    User([User]) --&gt;|Semantic Models| SM[Semantic Models]
    User --&gt;|"Dataflows (Gen2)"| DF["Dataflows (Gen2)"]
    User --&gt;|Paginated Reports| PR[Paginated Reports]
    SM --&gt; PPVS[Power Platform VNET Service]
    DF --&gt; PPVS
    PR --&gt; PPVS
    PPVS --&gt; MCVG[Managed Container<br/>for VNet Gateway]
    MCVG --&gt;|Interfaces with| SQLDB[(SQL Databases)]
    MCVG --&gt;|Interfaces with| FS[(File Storage)]
    MCVG --&gt;|Interfaces with| CS[(Cloud Services)]
    MCVG -.-&gt;|Secured by| SEC{{Security Features}}

    subgraph VNET_123
    SQLDB
    FS
    CS
    SEC
    end

    classDef filled fill:#f96,stroke:#333,stroke-width:2px;
    classDef user fill:#bbf,stroke:#f66,stroke-width:2px,stroke-dasharray: 5, 5;
    class User user
    class SM,DF,PR,PPVS,MCVG,SQLDB,FS,CS,SEC filled
</code></pre>
<p>The process begins with a user leveraging Power Platform services like Semantic Models, Dataflows (Gen2), and Paginated Reports. These services are designed to handle various data-related tasks, from analysis to visualization. They connect to the Power Platform VNET Service, which is the heart of the operation, orchestrating the flow of data through the managed container for the VNet gateway.</p>
<p>This managed container is a secure environment specifically designed for the VNet gatewayâs operations. Itâs isolated from the public internet, ensuring that the data remains protected within the confines of the virtual network. Within this secure environment, the VNet gateway interfaces with the necessary external resources, such as SQL databases and cloud storage, all while maintaining strict security protocols symbolized by the padlock icon in our diagram.</p>
<p>If you need to connect to services on others VNets, you can use <a href="https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-peering-overview">VNet peering</a> to connect the VNets, and maybe access to on-premises resources using <a href="https://docs.microsoft.com/en-us/azure/expressroute/expressroute-introduction">ExpressRoute</a> or other VPN solutions.</p>
<h3 id="the-benefits"><a class="toclink" href="../../../../2024/06/11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#the-benefits">The Benefits</a></h3>
<p>By utilizing a VNet data gateway, organizations can enjoy several benefits:</p>
<ul>
<li>Enhanced Security: The gateway provides a secure path for data, safeguarding sensitive information and complying with organizational security policies.</li>
<li>Network Isolation: The managed container and the virtual network setup ensure that the data does not traverse public internet spaces, reducing exposure to vulnerabilities.</li>
<li>Seamless Integration: The gateway facilitates smooth integration between Power Platform services and external data sources, enabling efficient data processing and analysis.</li>
</ul>
<h3 id="getting-started"><a class="toclink" href="../../../../2024/06/11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#getting-started">Getting Started</a></h3>
<p>To set up a VNet data gateway, follow these steps:</p>
<h4 id="register-microsoftpowerplatform-as-a-resource-provider"><a class="toclink" href="../../../../2024/06/11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#register-microsoftpowerplatform-as-a-resource-provider">Register Microsoft.PowerPlatform as a resource provider</a></h4>
<p>Before you can create a VNet data gateway, you need to register the Microsoft.PowerPlatform resource provider. This can be done using the Azure portal or the Azure CLI.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a>az provider register --namespace Microsoft.PowerPlatform
</span></code></pre></div>
<h4 id="associate-the-subnet-to-microsoft-power-platform"><a class="toclink" href="../../../../2024/06/11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#associate-the-subnet-to-microsoft-power-platform">Associate the subnet to Microsoft Power Platform</a></h4>
<p>Create a VNet in your Azure subscription and a subnet where the VNet data gateway will be deployed. Next, you need to delegate subnet to service <strong>Microsoft.PowerPlatform/vnetaccesslinks</strong>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>This subnet can't be shared with other services.</li>
<li>Five IP addresses are reserved in the subnet for basic functionality. You need to reserve additional IP addresses for the VNet data gateway, add more IPs for future gateways.</li>
<li>You need a role with the Microsoft.Network/virtualNetworks/subnets/join/action permission</li>
</ul>
</div>
<p>This can be done using the Azure portal or the Azure CLI.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a># Create a VNet and address prefix 10.0.0.0/24
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>az network vnet create --name MyVNet --resource-group MyResourceGroup --location eastus --address-prefixes 10.0.0.0/24
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a>
</span><span id="__span-7-5"><a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a># Create a Netwrok Security Group
</span><span id="__span-7-6"><a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a>az network nsg create --name MyNsg --resource-group MyResourceGroup --location eastus
</span><span id="__span-7-7"><a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a>
</span><span id="__span-7-8"><a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a># Create a subnet with delegation to Microsoft.PowerPlatform/vnetaccesslinks and associate the NSG
</span><span id="__span-7-9"><a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a>az network vnet subnet create --name MySubnet --vnet-name MyVNet --resource-group MyResourceGroup --address-prefixes 10.0.0.1/27 --network-security-group MyNsg --delegations Microsoft.PowerPlatform/vnetaccesslinks
</span></code></pre></div>
<h4 id="create-a-vnet-data-gateway"><a class="toclink" href="../../../../2024/06/11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#create-a-vnet-data-gateway">Create a VNet data gateway</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A Microsoft Power Platform User with with Microsoft.Network/virtualNetworks/subnets/join/action permission on the VNet is required. Network Contributor role is not necessary.</p>
</div>
<ol>
<li>Sign in to the <a href="https://app.powerbi.com/">Power BI homepage</a>.</li>
<li>In the top navigation bar, select the settings gear icon on the right.</li>
<li>From the drop down, select the Manage connections and gateways page, in Resources and extensions.</li>
<li>Select <strong>Create a virtual network data gateway.</strong>.</li>
<li>Select the license capacity, subscription, resource group, VNet and the Subnet. Only subnets that are delegated to Microsoft Power Platform are displayed in the drop-down list. VNET data gateways require a <a href="https://learn.microsoft.com/en-us/power-bi/enterprise/service-premium-what-is">Power BI Premium capacity</a> license (A4 SKU or higher or any P SKU) or <a href="https://learn.microsoft.com/en-us/fabric/enterprise/buy-subscription">Fabric license</a> to be used (any SKU).</li>
<li>By default, we provide a unique name for this data gateway, but you could optionally update it.</li>
<li>Select <strong>Save</strong>. This VNet data gateway is now displayed in your <strong>Virtual network data gateways</strong> tab. A VNet data gateway is a managed gateway that could be used for controlling access to this resource for Power platform users.</li>
</ol>
<h3 id="conclusion"><a class="toclink" href="../../../../2024/06/11/securely-connect-power-bi-to-data-sources-with-a-vnet-data-gateway/#conclusion">Conclusion</a></h3>
<p>The VNet data gateway is a powerful tool that enables secure data transfer between the Power Platform and external data sources residing within a virtual network. By leveraging this gateway, organizations can ensure that their data remains protected and compliant with security standards, all while facilitating seamless integration and analysis of data. If you are looking to enhance the security and reliability of your data connections, consider implementing a VNet data gateway in your environment.</p>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael FernÃ¡ndez" src="https://avatars.githubusercontent.com/u/39990341"/>
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-06-09 00:00:00">June 9, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../">Azure Services</a>, 
              <a class="md-meta__link" href="../../../finops/">FinOps</a></li>
<li class="md-meta__item">
            
              4 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="finops-for-azure-optimizing-your-cloud-spend"><a class="toclink" href="../../../../2024/06/09/finops-for-azure-optimizing-your-cloud-spend/">FinOps for Azure: Optimizing Your Cloud Spend</a></h2>
<p>In the cloud era, optimizing cloud spend has become a critical aspect of financial management. FinOps, a set of financial operations practices, empowers organizations to get the most out of their Azure investment. This blog post dives into the core principles of FinOps, explores the benefits it offers, and outlines practical strategies for implementing FinOps in your Azure environment.</p>
<h3 id="understanding-the-cloud-cost-challenge"><a class="toclink" href="../../../../2024/06/09/finops-for-azure-optimizing-your-cloud-spend/#understanding-the-cloud-cost-challenge">Understanding the Cloud Cost Challenge</a></h3>
<p>Traditional IT expenditure followed a capital expenditure (capex) model, where businesses purchased hardware and software upfront. Cloud computing introduces a paradigm shift with the operational expenditure (opex) model. Here, businesses pay for resources as they consume them, leading to variable and unpredictable costs.</p>
<p>FinOps tackles this challenge by providing a framework for managing cloud finances. It encompasses three key pillars:</p>
<ul>
<li><strong>People:</strong> Establish a FinOps team or designate individuals responsible for overseeing cloud costs. This team should possess a blend of cloud technical expertise, financial acumen, and business process knowledge.</li>
<li><strong>Process:</strong>  Define processes for budgeting, forecasting, and monitoring cloud expenses. This involves setting spending limits, creating chargeback models for different departments, and regularly reviewing cost reports.</li>
<li><strong>Tools:</strong> Leverage Azure Cost Management, a suite of tools that provides granular insights into your Azure spending. It enables cost allocation by resource, service, department, or any other relevant dimension.</li>
</ul>
<p>It's essential to adopt a FinOps mindset that encourages collaboration between finance, IT, and business teams to drive cost efficiency and value realization in the cloud.</p>
<p>It's important to note that FinOps is not just about cost-cutting; it's about optimizing cloud spending to align with business objectives and maximize ROI.</p>
<h3 id="azure-cost-management-optimizing-your-azure-spending"><a class="toclink" href="../../../../2024/06/09/finops-for-azure-optimizing-your-cloud-spend/#azure-cost-management-optimizing-your-azure-spending">Azure Cost Management: Optimizing Your Azure Spending</a></h3>
<p>Azure Cost Management empowers you to analyze your Azure spending patterns and identify cost-saving opportunities. Here's a glimpse into its key functionalities:</p>
<ul>
<li><strong>Cost Views:</strong> Generate comprehensive reports that categorize your Azure spending by various attributes like resource group, service, or department.</li>
<li><strong>Cost Alerts:</strong> Set up proactive alerts to notify you when your spending exceeds predefined thresholds.</li>
<li><strong>Reservations:</strong> Purchase reserved instances of frequently used Azure resources for significant upfront discounts.</li>
<li><strong>Recommendations:</strong> Azure Cost Management analyzes your usage patterns and recommends potential cost-saving measures, such as rightsizing resources or leveraging spot instances.</li>
</ul>
<h3 id="the-power-of-tags-and-azure-policy"><a class="toclink" href="../../../../2024/06/09/finops-for-azure-optimizing-your-cloud-spend/#the-power-of-tags-and-azure-policy">The Power of Tags and Azure Policy</a></h3>
<p>Tags are metadata labels that you can attach to your Azure resources to categorize and track them effectively. They play a pivotal role in FinOps by enabling you to:</p>
<ul>
<li>Associate costs with specific departments, projects, or applications.</li>
<li>Identify unused or underutilized resources for potential cost savings.</li>
<li>Simplify cost allocation and chargeback processes.</li>
</ul>
<p>Azure Policy helps enforce tagging standards and governance rules across your Azure environment. You can define policies that mandate specific tags for all resources, ensuring consistent cost allocation and data accuracy.</p>
<h3 id="benefits-of-implementing-finops"><a class="toclink" href="../../../../2024/06/09/finops-for-azure-optimizing-your-cloud-spend/#benefits-of-implementing-finops">Benefits of Implementing FinOps</a></h3>
<p>A well-defined FinOps strategy empowers you to:</p>
<ul>
<li><strong>Gain Visibility into Cloud Spending:</strong>  Obtain a clear picture of your Azure expenditures, enabling informed budgeting and cost control decisions.</li>
<li><strong>Optimize Cloud Costs:</strong> Identify and eliminate wasteful spending through cost-saving recommendations and proactive measures.</li>
<li><strong>Improve Cloud Governance:</strong>  Enforce tagging policies and spending limits to ensure responsible cloud resource utilization.</li>
<li><strong>Align Cloud Spending with Business Value:</strong>  Make data-driven decisions about cloud investments that support your business objectives.</li>
</ul>
<h3 id="getting-started-with-finops-in-azure"><a class="toclink" href="../../../../2024/06/09/finops-for-azure-optimizing-your-cloud-spend/#getting-started-with-finops-in-azure">Getting Started with FinOps in Azure</a></h3>
<p>Implementing FinOps doesn't necessitate a complex overhaul. Here's a recommended approach:</p>
<ol>
<li><strong>Establish a FinOps Team:</strong>  Assemble a cross-functional team comprising representatives from finance, IT, and business departments.</li>
<li><strong>Set Clear Goals and Objectives:</strong>  Define your FinOps goals, whether it's reducing costs by a specific percentage or improving budget forecasting accuracy.</li>
<li><strong>Leverage Azure Cost Management:</strong>  Start by exploring Azure Cost Management to understand your current spending patterns.</li>
<li><strong>Implement Basic Tagging Standards:</strong>  Enforce basic tagging policies to categorize your Azure resources for cost allocation purposes.</li>
<li><strong>Continuously Monitor and Refine:</strong>  Regularly review your cloud cost reports and identify areas for further optimization.</li>
</ol>
<p>By following these steps and embracing a FinOps culture, you can effectively manage your Azure expenses and derive maximum value from your cloud investment.</p>
<h3 id="toolchain-for-finops-in-azure"><a class="toclink" href="../../../../2024/06/09/finops-for-azure-optimizing-your-cloud-spend/#toolchain-for-finops-in-azure">Toolchain for FinOps in Azure</a></h3>
<p>To streamline your FinOps practices in Azure, consider leveraging the following tools:</p>
<pre class="mermaid"><code>graph LR
A[Financial Operations Practices] --&gt; B{Cloud Spend Optimization}
B --&gt; C{Cost Visibility}
B --&gt; D{Cost Optimization}
B --&gt; E{Governance}
C --&gt; F{Azure Cost Management}
D --&gt; G{Azure Advisor}
E --&gt; H{Azure Policy}
F --&gt; I{Cost Views}
F --&gt; J{Cost Alerts}
G --&gt; K{Cost Recommendations}
H --&gt; L{Tag Enforcement}
</code></pre>
<p>This toolchain combines Azure Cost Management, Azure Advisor, and Azure Policy to provide a comprehensive suite of capabilities for managing your Azure spending effectively.</p>
<p><strong>Highly recommended</strong>, you can check <a href="https://microsoft.github.io/finops-toolkit/">FinOps toolkit</a>, it's a set of tools and best practices to help you implement FinOps in your organization, it includes tools for cost allocation, budgeting, and forecasting, as well as best practices for FinOps implementation.</p>
<h3 id="conclusion"><a class="toclink" href="../../../../2024/06/09/finops-for-azure-optimizing-your-cloud-spend/#conclusion">Conclusion</a></h3>
<p>FinOps is an essential practice for organizations leveraging Azure. It empowers you to make informed decisions about your cloud finances, optimize spending, and achieve your business goals. As an Azure Solutions Architect, I recommend that you establish a FinOps practice within your organization to unlock the full potential of Azure and achieve financial efficiency in the cloud.</p>
<p>This blog post provides a foundational understanding of FinOps in Azure. </p>
<p>By embracing FinOps, you can transform your cloud cost management practices and drive business success in the cloud era.</p>
<h3 id="references"><a class="toclink" href="../../../../2024/06/09/finops-for-azure-optimizing-your-cloud-spend/#references">References</a></h3>
<ul>
<li><a href="https://www.youtube.com/watch?v=YHUptdFtozQ">Thanks John Savill</a></li>
<li><a href="https://microsoft.github.io/finops-toolkit/">FinOps toolkit</a></li>
</ul>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael FernÃ¡ndez" src="https://avatars.githubusercontent.com/u/39990341"/>
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-05-04 00:00:00">May 4, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../">Azure Services</a>, 
              <a class="md-meta__link" href="../../../snowflake/">Snowflake</a></li>
<li class="md-meta__item">
            
              5 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="reduce-your-attack-surface-in-snowflake-when-using-from-azure"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/">Reduce your attack surface in Snowflake when using from Azure</a></h2>
<p>When it comes to data security, reducing your attack surface is a crucial step. This post will guide you on how to minimize your attack surface when using Snowflake with Azure or Power BI.</p>
<h3 id="what-is-snowflake"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#what-is-snowflake">What is Snowflake?</a></h3>
<p>Snowflake is a cloud-based data warehousing platform that allows you to store and analyze large amounts of data. It is known for its scalability, performance, and ease of use. Snowflake is popular among organizations that need to process large volumes of data quickly and efficiently.</p>
<h3 id="what-is-an-attack-surface"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#what-is-an-attack-surface">What is an Attack Surface?</a></h3>
<p>An attack surface refers to the number of possible ways an attacker can get into a system and potentially extract data. The larger the attack surface, the more opportunities there are for attackers. Therefore, reducing the attack surface is a key aspect of securing your systems.</p>
<p>How to Reduce Your Attack Surface in Snowflake:</p>
<ol>
<li>
<p>Use Azure Private Link
Azure Private Link provides private connectivity from a virtual network to Snowflake, isolating your traffic from the public internet. It significantly reduces the attack surface by ensuring that traffic between Azure and Snowflake doesn't traverse over the public internet.</p>
</li>
<li>
<p>Implement Network Policies
Snowflake allows you to define network policies that restrict access based on IP addresses. By limiting access to trusted IP ranges, you can reduce the potential points of entry for an attacker.</p>
</li>
<li>
<p>Enable Multi-Factor Authentication (MFA)
MFA adds an extra layer of security by requiring users to provide at least two forms of identification before accessing the Snowflake account. This makes it harder for attackers to gain unauthorized access, even if they have your password.</p>
</li>
</ol>
<p>In this blog post, we will show you how to reduce your attack surface when using Snowflake from Azure or Power BI by using Azure Private Link</p>
<h3 id="default-snowflake-architecture"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#default-snowflake-architecture">Default Snowflake architecture</a></h3>
<p>By default, Snowflake is accessible from the public internet. This means that anyone with the right credentials can access your Snowflake account from anywhere in the world, you can limit access to specific IP addresses, but this still exposes your Snowflake account to potential attackers. </p>
<p>This is a security risk because it exposes your Snowflake account to potential attackers.</p>
<h3 id="using-azure-private-link-with-snowflake"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#using-azure-private-link-with-snowflake">Using Azure Private Link with Snowflake</a></h3>
<h4 id="simple-architecture-diagram-of-azure-private-link-with-snowflake"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#simple-architecture-diagram-of-azure-private-link-with-snowflake">Simple Architecture Diagram of Azure Private Link with Snowflake</a></h4>
<p>The architecture of using Azure Private Link with Snowflake is as follows:</p>
<pre class="mermaid"><code>    graph TD
    A[Virtual Network] --&gt;|Private Endpoint| B[Snowflake]
    B --&gt;|Private Link Service| C[Private Link Resource]
    C --&gt;|Private Connection| D[Virtual Network]
    D --&gt;|Subnet| E[Private Endpoint]    
</code></pre>
<h4 id="architecture-components"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#architecture-components">Architecture Components</a></h4>
<h4 id="requirements"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#requirements">Requirements</a></h4>
<p>Before you can use Azure Private Link with Snowflake, you need to have the following requirements in place:</p>
<ul>
<li>A Snowflake account with ACCOUNTADMIN privileges</li>
<li>Business Critical or higher Snowflake edition</li>
<li>An Azure subscription with a Resource Group  and privileges to create:<ul>
<li>Virtual Network</li>
<li>Subnet</li>
<li>Private Endpoint</li>
</ul>
</li>
</ul>
<h4 id="step-by-step-guide"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#step-by-step-guide">Step-by-Step Guide</a></h4>
<div class="admonition info">
<p class="admonition-title">Note</p>
<p>Replace the placeholders with your actual values, that is a orientation guide.</p>
</div>
<h5 id="step-1-retrieve-dedailts-of-your-snowflake-account"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#step-1-retrieve-dedailts-of-your-snowflake-account">Step 1: Retrieve Dedailts of your Snowflake Account</a></h5>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-27-1"><a href="#__codelineno-27-1" id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="n">USE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">ACCOUNTADMIN</span><span class="p">;</span>
</span><span id="__span-27-2"><a href="#__codelineno-27-2" id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="k">select</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="k">SYSTEM</span><span class="err">$</span><span class="n">GET_PRIVATELINK_CONFIG</span><span class="p">();</span>
</span></code></pre></div>
<h5 id="step-2-create-a-virtual-network"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#step-2-create-a-virtual-network">Step 2: Create a Virtual Network</a></h5>
<p>A virtual network is a private network that allows you to securely connect your resources in Azure. To create a virtual network with azcli, follow these steps:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a href="#__codelineno-28-1" id="__codelineno-28-1" name="__codelineno-28-1"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-2"><a href="#__codelineno-28-2" id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="w">  </span>--name<span class="w"> </span>myVnet<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-3"><a href="#__codelineno-28-3" id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="w">  </span>--resource-group<span class="w"> </span>myResourceGroup<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-4"><a href="#__codelineno-28-4" id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="w">  </span>--address-prefix
</span><span id="__span-28-5"><a href="#__codelineno-28-5" id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="w">  </span>--subnet-name<span class="w"> </span>mySubnet<span class="w"> </span><span class="se">\</span>
</span><span id="__span-28-6"><a href="#__codelineno-28-6" id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="w">  </span>--subnet-prefix
</span><span id="__span-28-7"><a href="#__codelineno-28-7" id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="w">  </span>--enable-private-endpoint-network-policies<span class="w"> </span><span class="nb">true</span>
</span></code></pre></div>
<h5 id="step-3-create-a-private-endpoint"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#step-3-create-a-private-endpoint">Step 3: Create a Private Endpoint</a></h5>
<p>The first step is to create a private endpoint in Azure. A private endpoint is a network interface that connects your virtual network to the Snowflake service. This allows you to access Snowflake using a private IP address, rather than a public one.</p>
<p>To create a private endpoint with azcli, follow these steps:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a href="#__codelineno-29-1" id="__codelineno-29-1" name="__codelineno-29-1"></a>az<span class="w"> </span>network<span class="w"> </span>private-endpoint<span class="w"> </span>create<span class="w"> </span><span class="se">\</span>
</span><span id="__span-29-2"><a href="#__codelineno-29-2" id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="w">  </span>--name<span class="w"> </span>mySnowflakeEndpoint<span class="w"> </span><span class="se">\</span>
</span><span id="__span-29-3"><a href="#__codelineno-29-3" id="__codelineno-29-3" name="__codelineno-29-3"></a><span class="w">  </span>--resource-group<span class="w"> </span>myResourceGroup<span class="w"> </span><span class="se">\</span>
</span><span id="__span-29-4"><a href="#__codelineno-29-4" id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="w">  </span>--vnet-name<span class="w"> </span>myVnet<span class="w"> </span><span class="se">\</span>
</span><span id="__span-29-5"><a href="#__codelineno-29-5" id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="w">  </span>--subnet<span class="w"> </span>mySubnet<span class="w"> </span><span class="se">\</span>
</span><span id="__span-29-6"><a href="#__codelineno-29-6" id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="w">  </span>--private-connection-resource-id<span class="w"> </span>/subscriptions/&lt;subscription-id&gt;/resourceGroups/&lt;resource-group&gt;/providers/Microsoft.Network/privateLinkServices/&lt;Snowflake-service-name&gt;<span class="w"> </span><span class="se">\</span>
</span><span id="__span-29-7"><a href="#__codelineno-29-7" id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="w">  </span>--connection-name<span class="w"> </span>mySnowflakeConnection
</span></code></pre></div>
<p>Check the status of the private endpoint:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a href="#__codelineno-30-1" id="__codelineno-30-1" name="__codelineno-30-1"></a>az<span class="w"> </span>network<span class="w"> </span>private-endpoint<span class="w"> </span>show<span class="w"> </span><span class="se">\</span>
</span><span id="__span-30-2"><a href="#__codelineno-30-2" id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="w">  </span>--name<span class="w"> </span>mySnowflakeEndpoint<span class="w"> </span><span class="se">\</span>
</span><span id="__span-30-3"><a href="#__codelineno-30-3" id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="w">  </span>--resource-group<span class="w"> </span>myResourceGroup
</span></code></pre></div>
<h5 id="step-4-authorize-the-private-endpoint"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#step-4-authorize-the-private-endpoint">Step 4: Authorize the Private Endpoint</a></h5>
<p>The next step is to authorize the private endpoint to access the Snowflake service. </p>
<p>Retrieve the Resource ID of the private endpoint:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a href="#__codelineno-31-1" id="__codelineno-31-1" name="__codelineno-31-1"></a>az<span class="w"> </span>network<span class="w"> </span>private-endpoint<span class="w"> </span>show<span class="w"> </span><span class="se">\</span>
</span><span id="__span-31-2"><a href="#__codelineno-31-2" id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="w">  </span>--name<span class="w"> </span>mySnowflakeEndpoint<span class="w"> </span><span class="se">\</span>
</span><span id="__span-31-3"><a href="#__codelineno-31-3" id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="w">  </span>--resource-group<span class="w"> </span>myResourceGroup
</span></code></pre></div>
<p>Create a temporary access token that Snowflake can use to authorize the private endpoint:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a href="#__codelineno-32-1" id="__codelineno-32-1" name="__codelineno-32-1"></a>az<span class="w"> </span>account<span class="w"> </span>get-access-token<span class="w"> </span>--subscription<span class="w"> </span>&lt;subscription-id&gt;
</span></code></pre></div>
<p>Authorize the private endpoint in Snowflake:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-33-1"><a href="#__codelineno-33-1" id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="n">USE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">ACCOUNTADMIN</span><span class="p">;</span>
</span><span id="__span-33-2"><a href="#__codelineno-33-2" id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="k">select</span><span class="w"> </span><span class="k">SYSTEM</span><span class="err">$</span><span class="n">AUTHORIZE_PRIVATELINK</span><span class="p">(</span><span class="s1">'&lt;resource-id&gt;'</span><span class="p">,</span><span class="w"> </span><span class="s1">'&lt;access-token&gt;'</span><span class="p">);</span>
</span></code></pre></div>
<h4 id="step-5-block-public-access"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#step-5-block-public-access">Step 5: Block Public Access</a></h4>
<p>To further reduce your attack surface, you can block public access to your Snowflake account. This ensures that all traffic to and from Snowflake goes through the private endpoint, reducing the risk of unauthorized access.</p>
<p>To block public access to your Snowflake account, you need to use Network Policy, follow these steps:</p>
<div class="language-sql highlight"><pre><span></span><code><span id="__span-34-1"><a href="#__codelineno-34-1" id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="n">USE</span><span class="w"> </span><span class="k">ROLE</span><span class="w"> </span><span class="n">ACCOUNTADMIN</span><span class="p">;</span>
</span><span id="__span-34-2"><a href="#__codelineno-34-2" id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">NETWORK</span><span class="w"> </span><span class="k">RULE</span><span class="w"> </span><span class="n">allow_access_rule</span>
</span><span id="__span-34-3"><a href="#__codelineno-34-3" id="__codelineno-34-3" name="__codelineno-34-3"></a><span class="w">  </span><span class="k">MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INGRESS</span>
</span><span id="__span-34-4"><a href="#__codelineno-34-4" id="__codelineno-34-4" name="__codelineno-34-4"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IPV4</span>
</span><span id="__span-34-5"><a href="#__codelineno-34-5" id="__codelineno-34-5" name="__codelineno-34-5"></a><span class="w">  </span><span class="n">VALUE_LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">'192.168.1.99/24'</span><span class="p">);</span>
</span><span id="__span-34-6"><a href="#__codelineno-34-6" id="__codelineno-34-6" name="__codelineno-34-6"></a>
</span><span id="__span-34-7"><a href="#__codelineno-34-7" id="__codelineno-34-7" name="__codelineno-34-7"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">NETWORK</span><span class="w"> </span><span class="k">RULE</span><span class="w"> </span><span class="n">block_access_rule</span>
</span><span id="__span-34-8"><a href="#__codelineno-34-8" id="__codelineno-34-8" name="__codelineno-34-8"></a><span class="w">  </span><span class="k">MODE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INGRESS</span>
</span><span id="__span-34-9"><a href="#__codelineno-34-9" id="__codelineno-34-9" name="__codelineno-34-9"></a><span class="w">  </span><span class="k">TYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IPV4</span>
</span><span id="__span-34-10"><a href="#__codelineno-34-10" id="__codelineno-34-10" name="__codelineno-34-10"></a><span class="w">  </span><span class="n">VALUE_LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">'0.0.0.0/0'</span><span class="p">);</span>
</span><span id="__span-34-11"><a href="#__codelineno-34-11" id="__codelineno-34-11" name="__codelineno-34-11"></a>
</span><span id="__span-34-12"><a href="#__codelineno-34-12" id="__codelineno-34-12" name="__codelineno-34-12"></a><span class="k">CREATE</span><span class="w"> </span><span class="n">NETWORK</span><span class="w"> </span><span class="n">POLICY</span><span class="w"> </span><span class="n">public_network_policy</span>
</span><span id="__span-34-13"><a href="#__codelineno-34-13" id="__codelineno-34-13" name="__codelineno-34-13"></a><span class="w">  </span><span class="n">ALLOWED_NETWORK_RULE_LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">'allow_access_rule'</span><span class="p">)</span>
</span><span id="__span-34-14"><a href="#__codelineno-34-14" id="__codelineno-34-14" name="__codelineno-34-14"></a><span class="w">  </span><span class="n">BLOCKED_NETWORK_RULE_LIST</span><span class="o">=</span><span class="p">(</span><span class="s1">'block_access_rule'</span><span class="p">);</span>
</span></code></pre></div>
<p>It's highly recommended to follow the best practices for network policies in Snowflake. You can find more information here:  https://docs.snowflake.com/en/user-guide/network-policies#best-practices</p>
<h4 id="step-6-test-the-connection"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#step-6-test-the-connection">Step 6: Test the Connection</a></h4>
<p>To test the connection between your virtual network and Snowflake, you can use the SnowSQL client. </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a href="#__codelineno-35-1" id="__codelineno-35-1" name="__codelineno-35-1"></a>snowsql<span class="w"> </span>-a<span class="w"> </span>&lt;account_name&gt;<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-r<span class="w"> </span>&lt;role&gt;<span class="w"> </span>-w<span class="w"> </span>&lt;warehouse&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database&gt;<span class="w"> </span>-s<span class="w"> </span>&lt;schema&gt;
</span></code></pre></div>
<h3 id="internal-stages-with-azure-blob-private-endpoints"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#internal-stages-with-azure-blob-private-endpoints">Internal Stages with Azure Blob Private Endpoints</a></h3>
<p>If you are using Azure Blob Storage as an internal stage in Snowflake, you can also use Azure Private Link to secure the connection between Snowflake and Azure Blob Storage.</p>
<p>It's recommended to use Azure Blob Storage with Private Endpoints to ensure that your data is secure and that you are reducing your attack surface, you can check the following documentation for more information: <a href="https://docs.snowflake.com/en/user-guide/private-internal-stages-azure">Azure Private Endpoints for Internal Stages</a> to learn how to configure Azure Blob Storage with Private Endpoints in Snowflake.</p>
<h3 id="conclusion"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#conclusion">Conclusion</a></h3>
<p>Reducing your attack surface is a critical aspect of securing your systems. By using Azure Private Link with Snowflake, you can significantly reduce the risk of unauthorized access and data breaches. Follow the steps outlined in this blog post to set up Azure Private Link with Snowflake and start securing your data today.</p>
<h3 id="references"><a class="toclink" href="../../../../2024/05/04/reduce-your-attack-surface-in-snowflake-when-using-from-azure/#references">References</a></h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/private-link/">Azure Private Link documentation</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/intro-editions">Snowflake Editions</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/functions/system_get_privatelink">$GET_PRIVATELINK_CONFIG();</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/network-policies">Snowflake Network Policies</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/private-internal-stages-azure">Azure Private Endpoints for Internal Stages</a></li>
</ul>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael FernÃ¡ndez" src="https://avatars.githubusercontent.com/u/39990341"/>
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-05-02 00:00:00">May 2, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../">Azure Services</a></li>
<li class="md-meta__item">
            
              2 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="azure-container-registry-artifact-cache"><a class="toclink" href="../../../../2024/05/02/azure-container-registry-artifact-cache/">Azure Container Registry: Artifact Cache</a></h2>
<p>Azure Container Registry is a managed, private Docker registry service provided by Microsoft. It allows you to build, store, and manage container images and artifacts in a secure environment. </p>
<h3 id="what-is-artifact-caching"><a class="toclink" href="../../../../2024/05/02/azure-container-registry-artifact-cache/#what-is-artifact-caching">What is Artifact Caching?</a></h3>
<p>Artifact Cache is a feature in Azure Container Registry that allows users to cache container images in a private container registry. It is available in Basic, Standard, and Premium service tiers.</p>
<h4 id="benefits-of-artifact-cache"><a class="toclink" href="../../../../2024/05/02/azure-container-registry-artifact-cache/#benefits-of-artifact-cache">Benefits of Artifact Cache</a></h4>
<ul>
<li><strong>Reliable pull operations</strong>: Faster pulls of container images are achievable by caching the container images in ACR.</li>
<li><strong>Private networks</strong>: Cached registries are available on private networks.</li>
<li><strong>Ensuring upstream content is delivered</strong>: Artifact Cache allows users to pull images from the local ACR instead of the upstream registry.</li>
</ul>
<h3 id="limitations"><a class="toclink" href="../../../../2024/05/02/azure-container-registry-artifact-cache/#limitations">Limitations</a></h3>
<p>Cache will only occur after at least one image pull is complete on the available container image</p>
<h3 id="how-to-use-artifact-cache-in-azure-container-registry-without-credential"><a class="toclink" href="../../../../2024/05/02/azure-container-registry-artifact-cache/#how-to-use-artifact-cache-in-azure-container-registry-without-credential">How to Use Artifact Cache in Azure Container Registry without credential?</a></h3>
<p>Let's take a look at how you can implement artifact caching in Azure Container Registry.</p>
<h4 id="step-1-create-a-cache-rule"><a class="toclink" href="../../../../2024/05/02/azure-container-registry-artifact-cache/#step-1-create-a-cache-rule">Step 1: Create a Cache Rule</a></h4>
<p>The first step is to create a cache rule in your Azure Container Registry. This rule specifies the source image that should be cached and the target image that will be stored in the cache.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>az<span class="w"> </span>acr<span class="w"> </span>cache<span class="w"> </span>create<span class="w"> </span>-r<span class="w"> </span>MyRegistry<span class="w"> </span>-n<span class="w"> </span>MyRule<span class="w"> </span>-s<span class="w"> </span>docker.io/library/ubuntu<span class="w"> </span>-t<span class="w"> </span>ubuntu
</span></code></pre></div>
<p>Check the cache rule:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>az<span class="w"> </span>acr<span class="w"> </span>cache<span class="w"> </span>show<span class="w"> </span>-r<span class="w"> </span>MyRegistry<span class="w"> </span>-n<span class="w"> </span>MyRule
</span></code></pre></div>
<h4 id="step-2-pull-the-image"><a class="toclink" href="../../../../2024/05/02/azure-container-registry-artifact-cache/#step-2-pull-the-image">Step 2: Pull the Image</a></h4>
<p>Next, you need to pull the image from the source registry to the cache. This will download the image and store it in the cache for future use.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a>docker<span class="w"> </span>pull<span class="w"> </span>myregistry.azurecr.io/hello-world:latest
</span></code></pre></div>
<h4 id="step-3-clean-up-the-resources"><a class="toclink" href="../../../../2024/05/02/azure-container-registry-artifact-cache/#step-3-clean-up-the-resources">Step 3: Clean up the resources</a></h4>
<p>Finally, you can clean up the resources by deleting the cache rule.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a>az<span class="w"> </span>acr<span class="w"> </span>cache<span class="w"> </span>delete<span class="w"> </span>-r<span class="w"> </span>MyRegistry<span class="w"> </span>-n<span class="w"> </span>MyRule
</span></code></pre></div>
<p>If you need to check other rules, you can use the following command:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a>az<span class="w"> </span>acr<span class="w"> </span>cache<span class="w"> </span>list<span class="w"> </span>-r<span class="w"> </span>MyRegistry
</span></code></pre></div>
<h3 id="conclusion"><a class="toclink" href="../../../../2024/05/02/azure-container-registry-artifact-cache/#conclusion">Conclusion</a></h3>
<p>Azure Container Registry's Artifact Cache feature provides a convenient way to cache container images in a private registry, improving pull performance and reducing network traffic. By following the steps outlined in this article, you can easily set up and use artifact caching in your Azure Container Registry.</p>
<p>If you need to use the cache with authentication, you can use the following article: <a href="https://learn.microsoft.com/en-us/azure/container-registry/tutorial-enable-artifact-cache-auth-cli">Enable Artifact Cache with authentication</a>.</p>
<p>For more detailed information, please visit the <a href="https://learn.microsoft.com/en-us/azure/container-registry/tutorial-artifact-cache">official tutorial</a> on the Microsoft Azure website.</p>
<h3 id="references"><a class="toclink" href="../../../../2024/05/02/azure-container-registry-artifact-cache/#references">References</a></h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/container-registry/">Azure Container Registry Documentation</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/container-registry/tutorial-artifact-cache">Azure Container Artifact Cache Overview</a></li>
</ul>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael FernÃ¡ndez" src="https://avatars.githubusercontent.com/u/39990341"/>
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-04-24 00:00:00">April 24, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../">Azure Services</a></li>
<li class="md-meta__item">
            
              4 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="how-to-create-a-management-group-diagram-with-drawio"><a class="toclink" href="../../../../2024/04/24/how-to-create-a-management-group-diagram-with-drawio/">How to create a Management Group diagram with draw.io</a></h2>
<p>I nedd to create a diagram of the Management Groups in Azure, and I remembered a project that did something similar but with PowerShell: https://github.com/PowerShellToday/new-mgmgroupdiagram.</p>
<h3 id="export-your-management-group-structure-from-azure-portal-or-ask-for-it"><a class="toclink" href="../../../../2024/04/24/how-to-create-a-management-group-diagram-with-drawio/#export-your-management-group-structure-from-azure-portal-or-ask-for-it">Export your Management Group structure from Azure Portal or ask for it</a></h3>
<p>If you can access the Azure Portal, you can export the Management Group structure to a CSV file. To do this, follow these steps:</p>
<ol>
<li>Go to the <strong>Azure portal</strong>.</li>
<li>Navigate to <strong>Management groups</strong>.</li>
<li>Click on <strong>Export</strong>.</li>
<li>Save the CSV file to your local machine.</li>
</ol>
<p>If you don't have access to the Azure Portal, you can ask your Azure administrator to export the Management Group structure for you.</p>
<p>The file has the following columns:</p>
<ul>
<li>id: The unique identifier of the Management Group or subscription.</li>
<li>displayName: The name of the Management Group or subscription.</li>
<li>itemType: The type of the item (Management Group or subscription).</li>
<li>path: The path to the management or subscription group, its parent.</li>
<li>accessLevel: Your access level.</li>
<li>childSubscriptionCount: The number of child subscriptions at this level.</li>
<li>totalSubscriptionCount: The total number of subscriptions.</li>
</ul>
<h3 id="create-a-csv-to-be-imported-into-drawio"><a class="toclink" href="../../../../2024/04/24/how-to-create-a-management-group-diagram-with-drawio/#create-a-csv-to-be-imported-into-drawio">Create a CSV to be imported into draw.io</a></h3>
<ol>
<li>Import the CSV file to excel, rename the sheet to "Export_Portal"</li>
<li>Create a second sheet with the following columns:<ul>
<li>id: reference to the id in the first sheet</li>
<li>displayName: reference to the displayName in the first sheet</li>
<li>itemType: reference to the itemType in the first sheet</li>
<li>ParentId: Use the following formula to get the parent of the current item:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>=IF(ISERROR(FIND(","; Export_Portal!D2)); Export_Portal!D2; TRIM(RIGHT(SUBSTITUTE(Export_Portal!D2; ","; REPT(" "; LEN(Export_Portal!D2))); LEN(Export_Portal!D2))))
</span></code></pre></div></li>
</ul>
</li>
<li>Export the second sheet to a CSV file.</li>
</ol>
<h3 id="import-the-csv-file-into-drawio"><a class="toclink" href="../../../../2024/04/24/how-to-create-a-management-group-diagram-with-drawio/#import-the-csv-file-into-drawio">Import the CSV file into draw.io</a></h3>
<ol>
<li>Go to <a href="https://app.diagrams.net/">draw.io</a> and create a new diagram.</li>
<li>Click on Arrange &gt; Insert &gt; Advanced &gt; CSV.</li>
<li>
<p>Insert the header for the columns: id, displayName, itemType, Parent:</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>    #label: %displayName%
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>    #stylename: itemType
</span><span id="__span-9-3"><a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a>    #styles: {"Management Group": "label;image=img/lib/azure2/general/Management_Groups.svg;whiteSpace=wrap;html=1;rounded=1; fillColor=%fill%;strokeColor=#6c8ebf;fillColor=#dae8fc;points=[[0.5,0,0,0,0],[0.5,1,0,0,0]];",\
</span><span id="__span-9-4"><a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a>    #"Subscription": "label;image=img/lib/azure2/general/Subscriptions.svg;whiteSpace=wrap;html=1;rounded=1; fillColor=%fill%;strokeColor=#d6b656;fillColor=#fff2cc;points=[[0.5,0,0,0,0],[0.5,1,0,0,0]];imageWidth=26;"}
</span><span id="__span-9-5"><a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a>    #
</span><span id="__span-9-6"><a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a>    #
</span><span id="__span-9-7"><a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a>    #namespace: csvimport-
</span><span id="__span-9-8"><a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a>    #
</span><span id="__span-9-9"><a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a>    #connect: {"from": "ParentId", "to": "displayName", "invert": true, "style": "curved=1;endArrow=blockThin;endFill=1;fontSize=11;edgeStyle=orthogonalEdgeStyle;"}
</span><span id="__span-9-10"><a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a>    #
</span><span id="__span-9-11"><a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a>    ## Node width and height, and padding for autosize
</span><span id="__span-9-12"><a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a>    #width: auto
</span><span id="__span-9-13"><a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a>    #height: auto
</span><span id="__span-9-14"><a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a>    #padding: -12
</span><span id="__span-9-15"><a href="#__codelineno-9-15" id="__codelineno-9-15" name="__codelineno-9-15"></a>    #
</span><span id="__span-9-16"><a href="#__codelineno-9-16" id="__codelineno-9-16" name="__codelineno-9-16"></a>    ## ignore: id,image,fill,stroke,refs,manager
</span><span id="__span-9-17"><a href="#__codelineno-9-17" id="__codelineno-9-17" name="__codelineno-9-17"></a>    #
</span><span id="__span-9-18"><a href="#__codelineno-9-18" id="__codelineno-9-18" name="__codelineno-9-18"></a>    ## Column to be renamed to link attribute (used as link).
</span><span id="__span-9-19"><a href="#__codelineno-9-19" id="__codelineno-9-19" name="__codelineno-9-19"></a>    ## link: url
</span><span id="__span-9-20"><a href="#__codelineno-9-20" id="__codelineno-9-20" name="__codelineno-9-20"></a>    #
</span><span id="__span-9-21"><a href="#__codelineno-9-21" id="__codelineno-9-21" name="__codelineno-9-21"></a>    ## Spacing between nodes, heirarchical levels and parallel connections.
</span><span id="__span-9-22"><a href="#__codelineno-9-22" id="__codelineno-9-22" name="__codelineno-9-22"></a>    #nodespacing: 40
</span><span id="__span-9-23"><a href="#__codelineno-9-23" id="__codelineno-9-23" name="__codelineno-9-23"></a>    #levelspacing: 100
</span><span id="__span-9-24"><a href="#__codelineno-9-24" id="__codelineno-9-24" name="__codelineno-9-24"></a>    #edgespacing: 40
</span><span id="__span-9-25"><a href="#__codelineno-9-25" id="__codelineno-9-25" name="__codelineno-9-25"></a>    #
</span><span id="__span-9-26"><a href="#__codelineno-9-26" id="__codelineno-9-26" name="__codelineno-9-26"></a>    ## layout: auto
</span><span id="__span-9-27"><a href="#__codelineno-9-27" id="__codelineno-9-27" name="__codelineno-9-27"></a>    #layout: verticaltree
</span><span id="__span-9-28"><a href="#__codelineno-9-28" id="__codelineno-9-28" name="__codelineno-9-28"></a>    #
</span><span id="__span-9-29"><a href="#__codelineno-9-29" id="__codelineno-9-29" name="__codelineno-9-29"></a>    ## ---- CSV below this line. First line are column names. ----
</span></code></pre></div>
4. Paste the content of the CSV file and click on Import.</p>
</li>
</ol>
<p>You should see a diagram with the Management Groups and Subscriptions.</p>
<p>For example:</p>
<p>This is the common structure for the Management Groups in the Enterprise Scale Landing Zone, now Accelerator Landing Zone: </p>
<pre class="mermaid"><code>    graph TD
        A[Root Management Group] --&gt; B[Intermediary-Management-Group]
        B --&gt; C[Decommissioned]
        B --&gt; D[Landing Zones]
        B --&gt; E[Platform]
        B --&gt; F[Sandboxes]
        D --&gt; G[Corp]
        D --&gt; H[Online]
        E --&gt; I[Connectivity]
        E --&gt; J[Identity]
        E --&gt; K[Management]        
</code></pre>
<p>And this is the CSV file to import into draw.io:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>#label: %displayName%
</span><span id="__span-10-2"><a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>#stylename: itemType
</span><span id="__span-10-3"><a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>#styles: {"Management Group": "label;image=img/lib/azure2/general/Management_Groups.svg;whiteSpace=wrap;html=1;rounded=1; fillColor=%fill%;strokeColor=#6c8ebf;fillColor=#dae8fc;points=[[0.5,0,0,0,0],[0.5,1,0,0,0]];",\
</span><span id="__span-10-4"><a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a>#"Subscription": "label;image=img/lib/azure2/general/Subscriptions.svg;whiteSpace=wrap;html=1;rounded=1; fillColor=%fill%;strokeColor=#d6b656;fillColor=#fff2cc;points=[[0.5,0,0,0,0],[0.5,1,0,0,0]];imageWidth=26;"}
</span><span id="__span-10-5"><a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>#
</span><span id="__span-10-6"><a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a>#
</span><span id="__span-10-7"><a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a>#namespace: csvimport-
</span><span id="__span-10-8"><a href="#__codelineno-10-8" id="__codelineno-10-8" name="__codelineno-10-8"></a>#
</span><span id="__span-10-9"><a href="#__codelineno-10-9" id="__codelineno-10-9" name="__codelineno-10-9"></a>#connect: {"from": "ParentId", "to": "displayName", "invert": true, "style": "curved=1;endArrow=blockThin;endFill=1;fontSize=11;edgeStyle=orthogonalEdgeStyle;"}
</span><span id="__span-10-10"><a href="#__codelineno-10-10" id="__codelineno-10-10" name="__codelineno-10-10"></a>#
</span><span id="__span-10-11"><a href="#__codelineno-10-11" id="__codelineno-10-11" name="__codelineno-10-11"></a>## Node width and height, and padding for autosize
</span><span id="__span-10-12"><a href="#__codelineno-10-12" id="__codelineno-10-12" name="__codelineno-10-12"></a>#width: auto
</span><span id="__span-10-13"><a href="#__codelineno-10-13" id="__codelineno-10-13" name="__codelineno-10-13"></a>#height: auto
</span><span id="__span-10-14"><a href="#__codelineno-10-14" id="__codelineno-10-14" name="__codelineno-10-14"></a>#padding: -12
</span><span id="__span-10-15"><a href="#__codelineno-10-15" id="__codelineno-10-15" name="__codelineno-10-15"></a>#
</span><span id="__span-10-16"><a href="#__codelineno-10-16" id="__codelineno-10-16" name="__codelineno-10-16"></a>## ignore: id,image,fill,stroke,refs,manager
</span><span id="__span-10-17"><a href="#__codelineno-10-17" id="__codelineno-10-17" name="__codelineno-10-17"></a>#
</span><span id="__span-10-18"><a href="#__codelineno-10-18" id="__codelineno-10-18" name="__codelineno-10-18"></a>## Column to be renamed to link attribute (used as link).
</span><span id="__span-10-19"><a href="#__codelineno-10-19" id="__codelineno-10-19" name="__codelineno-10-19"></a>## link: url
</span><span id="__span-10-20"><a href="#__codelineno-10-20" id="__codelineno-10-20" name="__codelineno-10-20"></a>#
</span><span id="__span-10-21"><a href="#__codelineno-10-21" id="__codelineno-10-21" name="__codelineno-10-21"></a>## Spacing between nodes, heirarchical levels and parallel connections.
</span><span id="__span-10-22"><a href="#__codelineno-10-22" id="__codelineno-10-22" name="__codelineno-10-22"></a>#nodespacing: 40
</span><span id="__span-10-23"><a href="#__codelineno-10-23" id="__codelineno-10-23" name="__codelineno-10-23"></a>#levelspacing: 100
</span><span id="__span-10-24"><a href="#__codelineno-10-24" id="__codelineno-10-24" name="__codelineno-10-24"></a>#edgespacing: 40
</span><span id="__span-10-25"><a href="#__codelineno-10-25" id="__codelineno-10-25" name="__codelineno-10-25"></a>#
</span><span id="__span-10-26"><a href="#__codelineno-10-26" id="__codelineno-10-26" name="__codelineno-10-26"></a>## layout: auto
</span><span id="__span-10-27"><a href="#__codelineno-10-27" id="__codelineno-10-27" name="__codelineno-10-27"></a>#layout: verticaltree
</span><span id="__span-10-28"><a href="#__codelineno-10-28" id="__codelineno-10-28" name="__codelineno-10-28"></a>#
</span><span id="__span-10-29"><a href="#__codelineno-10-29" id="__codelineno-10-29" name="__codelineno-10-29"></a>## ---- CSV below this line. First line are column names. ----
</span><span id="__span-10-30"><a href="#__codelineno-10-30" id="__codelineno-10-30" name="__codelineno-10-30"></a>id,displayName,itemType,ParentId
</span><span id="__span-10-31"><a href="#__codelineno-10-31" id="__codelineno-10-31" name="__codelineno-10-31"></a>1,Tenant Root Group,Management Group,
</span><span id="__span-10-32"><a href="#__codelineno-10-32" id="__codelineno-10-32" name="__codelineno-10-32"></a>2,Intermediary Management Group,Management Group,Tenant Root Group
</span><span id="__span-10-33"><a href="#__codelineno-10-33" id="__codelineno-10-33" name="__codelineno-10-33"></a>3,Decommissioned,Management Group,Intermediary Management Group
</span><span id="__span-10-34"><a href="#__codelineno-10-34" id="__codelineno-10-34" name="__codelineno-10-34"></a>4,Landing Zones,Management Group,Intermediary Management Group
</span><span id="__span-10-35"><a href="#__codelineno-10-35" id="__codelineno-10-35" name="__codelineno-10-35"></a>5,Platform,Management Group,Intermediary Management Group
</span><span id="__span-10-36"><a href="#__codelineno-10-36" id="__codelineno-10-36" name="__codelineno-10-36"></a>6,Sandboxes,Management Group,Landing Zones
</span><span id="__span-10-37"><a href="#__codelineno-10-37" id="__codelineno-10-37" name="__codelineno-10-37"></a>7,Corp,Management Group,Landing Zones
</span><span id="__span-10-38"><a href="#__codelineno-10-38" id="__codelineno-10-38" name="__codelineno-10-38"></a>8,Online,Management Group,Landing Zones
</span><span id="__span-10-39"><a href="#__codelineno-10-39" id="__codelineno-10-39" name="__codelineno-10-39"></a>9,Connectivity,Management Group,Platform
</span><span id="__span-10-40"><a href="#__codelineno-10-40" id="__codelineno-10-40" name="__codelineno-10-40"></a>10,Identity,Management Group,Platform
</span><span id="__span-10-41"><a href="#__codelineno-10-41" id="__codelineno-10-41" name="__codelineno-10-41"></a>11,Management,Management Group,Platform
</span><span id="__span-10-42"><a href="#__codelineno-10-42" id="__codelineno-10-42" name="__codelineno-10-42"></a>12,subcr-1,Subscription,Decommissioned
</span><span id="__span-10-43"><a href="#__codelineno-10-43" id="__codelineno-10-43" name="__codelineno-10-43"></a>13,subcr-2,Subscription,Sandboxes
</span><span id="__span-10-44"><a href="#__codelineno-10-44" id="__codelineno-10-44" name="__codelineno-10-44"></a>14,subcr-3,Subscription,Corp
</span><span id="__span-10-45"><a href="#__codelineno-10-45" id="__codelineno-10-45" name="__codelineno-10-45"></a>15,subcr-4,Subscription,Online
</span><span id="__span-10-46"><a href="#__codelineno-10-46" id="__codelineno-10-46" name="__codelineno-10-46"></a>16,subcr-5,Subscription,Connectivity
</span><span id="__span-10-47"><a href="#__codelineno-10-47" id="__codelineno-10-47" name="__codelineno-10-47"></a>17,subcr-6,Subscription,Identity
</span><span id="__span-10-48"><a href="#__codelineno-10-48" id="__codelineno-10-48" name="__codelineno-10-48"></a>18,subcr-7,Subscription,Management
</span></code></pre></div>
<h3 id="make-your-diagram-animated-and-interactive"><a class="toclink" href="../../../../2024/04/24/how-to-create-a-management-group-diagram-with-drawio/#make-your-diagram-animated-and-interactive">Make your diagram animated and interactive</a></h3>
<p>You can make your diagram animated and interactive by following these steps:</p>
<ol>
<li>File &gt; Export as &gt; URL</li>
<li>Add p=ex&amp; after the first ? in the URL.</li>
</ol>
<p>For example, the URL should look like this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>https://viewer.diagrams.net/?p=ex&amp;tags=%7B%7D&amp;highlight=0000ff&amp;layers=1&amp;nav=1&amp;title=MGs.drawio#R7Zxbc5s4FMc%2FjR%2BbAQkEPK7dJHWn3XbW6exMX3ZkkLFakDxCvvXTr7jFxrZi1k0Wg5lxYnR0QfqfHxqOBB7AUbx5FHgx%2F8wDEg2AEWwG8P0AAGAgQ32llm1uMU0X5pZQ0KCw7QwT%2BosUxqJiuKQBSSoFJeeRpIuq0eeMEV9WbFgIvq4Wm%2FGoetYFDsmRYeLj6Nj6Nw3kvBwG8nYZHwgN58WpXeDkGTEuCxcjSeY44Os9E7wfwJHgXOZH8WZEolS9Upe83oMm97ljgjB5osK3hIgv0x%2BpJsCI8FQ5Jis0AHZAk0WEt3%2FimKhU3k7Z7HBLxq7x42mcwOHy%2B0dn9PCRvIOFz%2FYrZqWfCMMsPcFf6TCA8Sj4clE0KEn8tF0UBT9jpoSKCTso9TXr%2Fjgo%2B5YNKcI%2BmStHEbHvvKoMidyWLioGN6Rx7ksah0qFiE7Vf%2FxrKUgqSkgYEVjVfNh15Z%2BsI8ldsgpV9fVcdXmyUOdWbawVzso2l3Eqm6kOVVEWkKBIpSjRKBrxiIusF3aaTNWEw0QK%2FpPssiDyXTKdqZxqFRhg4s58ZV9wymQ2VnuoPsadcsrIqPzZqsLoOc88zFOftFOpfCsiJNloIdnX8pHwmEixVUWKCpYD7goituU1nCfXO%2FqB4ea2%2BR74dmHDhc%2FC57Z3TKqDwoFlco%2FS16fW0lA7ZpKImAQUZ0PXsXkJwS9cED3WDWINnQOsTegec%2B20g2tbw%2FV74vM4pklCOVMuvRjimtdHD3RzQJezcjlJ2%2BiIZtNrB81IQ%2FMnzALKFCLGd4Vz0uPcYZyhZ57nuSWzs6Ph%2BWuE5YyLuAe5wyB7rn0eZKsdILsakCdqYp7yze9MySfn9p7bBu8nAKxwCx3rmFvUDm49DbcjLn4jsuuRvTJkLWieRxa0AlnL0CD7hUWUkR7azkBre955aGE7oDW182y2FE9XVG4vR7d6u9wz2xyzjuN05d7AAhpmx4ESo%2Be1E7wexmBtnmN1G2%2F7TPbEtp1Y00Q1wq92rH9Zul23ZDn1xTvzFK%2BT5TTxBV1IytkpUk9tbLwxr%2FtdentWAzRFNjpmdTabAf8VWc0GXz7HANAr3dPWmG5bEofpdtZydsEl7B6slvXYXgu2wKrOuZYHWsutbg8t5xZewu1utaxH9lqQPVzyajOyum2yHFnrEmT3V8t6aK8FWmRYnYFWtyWWQ2tfAu3xalmP7rWg63hOZ9DV7Yrl6KJL0K0umvXYXgu2nmd0BVtbtzOWY%2Btcgu3h2lkP7rWAa5qu2yS5Ry9ZnGayGNcKR0tSog2qjPhLsXp2IGHBH%2BmrKCo5jbj%2F82lOWW5%2BSB2ZF5pxJovXX8ysUhCSSdEgF3LOQ85wdL%2BzFoKn5V6WW3WML4VPXhhS%2BYKHxCIk8qWC1mkHChJhdQ9T7cl%2FcEZN5UH3lLfqKm83qjy8YeVRo8pbN6y806jydveUR3WVdxtVHt2w8l6jyju3q3z%2BFF5jyrvdU96pq7wmLPiflPduWHnQpPLlrwPcpPKwUeU7GMPadZVvNIZFHYxh3brKNxrDog7GsF5d5RuNYVH3YtjylY3zyjcaw6LuxbDlewfnlW80hkXdi2HLp%2BfPK99oDIu6F8Naddfn7TeKYVVy90tVWd7eD37B%2B38B#%7B%22pageId%22%3A%22UGUHswWqf16rUITyRAQM%22%7D
</span></code></pre></div>
<p>You can check it <a href="https://viewer.diagrams.net/?p=ex&amp;tags=%7B%7D&amp;highlight=0000ff&amp;layers=1&amp;nav=1&amp;title=MGs.drawio#R7Zxbc5s4FMc%2FjR%2BbAQkEPK7dJHWn3XbW6exMX3ZkkLFakDxCvvXTr7jFxrZi1k0Wg5lxYnR0QfqfHxqOBB7AUbx5FHgx%2F8wDEg2AEWwG8P0AAGAgQ32llm1uMU0X5pZQ0KCw7QwT%2BosUxqJiuKQBSSoFJeeRpIuq0eeMEV9WbFgIvq4Wm%2FGoetYFDsmRYeLj6Nj6Nw3kvBwG8nYZHwgN58WpXeDkGTEuCxcjSeY44Os9E7wfwJHgXOZH8WZEolS9Upe83oMm97ljgjB5osK3hIgv0x%2BpJsCI8FQ5Jis0AHZAk0WEt3%2FimKhU3k7Z7HBLxq7x42mcwOHy%2B0dn9PCRvIOFz%2FYrZqWfCMMsPcFf6TCA8Sj4clE0KEn8tF0UBT9jpoSKCTso9TXr%2Fjgo%2B5YNKcI%2BmStHEbHvvKoMidyWLioGN6Rx7ksah0qFiE7Vf%2FxrKUgqSkgYEVjVfNh15Z%2BsI8ldsgpV9fVcdXmyUOdWbawVzso2l3Eqm6kOVVEWkKBIpSjRKBrxiIusF3aaTNWEw0QK%2FpPssiDyXTKdqZxqFRhg4s58ZV9wymQ2VnuoPsadcsrIqPzZqsLoOc88zFOftFOpfCsiJNloIdnX8pHwmEixVUWKCpYD7goituU1nCfXO%2FqB4ea2%2BR74dmHDhc%2FC57Z3TKqDwoFlco%2FS16fW0lA7ZpKImAQUZ0PXsXkJwS9cED3WDWINnQOsTegec%2B20g2tbw%2FV74vM4pklCOVMuvRjimtdHD3RzQJezcjlJ2%2BiIZtNrB81IQ%2FMnzALKFCLGd4Vz0uPcYZyhZ57nuSWzs6Ph%2BWuE5YyLuAe5wyB7rn0eZKsdILsakCdqYp7yze9MySfn9p7bBu8nAKxwCx3rmFvUDm49DbcjLn4jsuuRvTJkLWieRxa0AlnL0CD7hUWUkR7azkBre955aGE7oDW182y2FE9XVG4vR7d6u9wz2xyzjuN05d7AAhpmx4ESo%2Be1E7wexmBtnmN1G2%2F7TPbEtp1Y00Q1wq92rH9Zul23ZDn1xTvzFK%2BT5TTxBV1IytkpUk9tbLwxr%2FtdentWAzRFNjpmdTabAf8VWc0GXz7HANAr3dPWmG5bEofpdtZydsEl7B6slvXYXgu2wKrOuZYHWsutbg8t5xZewu1utaxH9lqQPVzyajOyum2yHFnrEmT3V8t6aK8FWmRYnYFWtyWWQ2tfAu3xalmP7rWg63hOZ9DV7Yrl6KJL0K0umvXYXgu2nmd0BVtbtzOWY%2Btcgu3h2lkP7rWAa5qu2yS5Ry9ZnGayGNcKR0tSog2qjPhLsXp2IGHBH%2BmrKCo5jbj%2F82lOWW5%2BSB2ZF5pxJovXX8ysUhCSSdEgF3LOQ85wdL%2BzFoKn5V6WW3WML4VPXhhS%2BYKHxCIk8qWC1mkHChJhdQ9T7cl%2FcEZN5UH3lLfqKm83qjy8YeVRo8pbN6y806jydveUR3WVdxtVHt2w8l6jyju3q3z%2BFF5jyrvdU96pq7wmLPiflPduWHnQpPLlrwPcpPKwUeU7GMPadZVvNIZFHYxh3brKNxrDog7GsF5d5RuNYVH3YtjylY3zyjcaw6LuxbDlewfnlW80hkXdi2HLp%2BfPK99oDIu6F8Naddfn7TeKYVVy90tVWd7eD37B%2B38B#%7B%22pageId%22%3A%22UGUHswWqf16rUITyRAQM%22%7D">here</a></p>
<h3 id="references"><a class="toclink" href="../../../../2024/04/24/how-to-create-a-management-group-diagram-with-drawio/#references">References</a></h3>
<ul>
<li><a href="https://drawio-app.com/blog/automatically-create-draw-io-diagrams-from-csv-files/">Automatically create draw.io diagrams from CSV files</a></li>
<li><a href="https://drawio-app.com/blog/animation-and-automatic-layout-explore-complex-diagrams/">Animation and Automatic Layout: Explore Complex Diagrams</a></li>
</ul>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael FernÃ¡ndez" src="https://avatars.githubusercontent.com/u/39990341"/>
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-04-23 00:00:00">April 23, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../">Azure Services</a></li>
<li class="md-meta__item">
            
              2 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="moving-management-groups-and-subscriptions"><a class="toclink" href="../../../../2024/04/23/moving-management-groups-and-subscriptions/">Moving Management Groups and Subscriptions</a></h2>
<p>Managing your Azure resources efficiently often involves moving management groups and subscriptions. Here's a brief guide on how to do it:</p>
<h3 id="moving-management-groups"><a class="toclink" href="../../../../2024/04/23/moving-management-groups-and-subscriptions/#moving-management-groups">Moving Management Groups</a></h3>
<p>To move a management group, you need to have the necessary permissions. You must be an owner of the target parent management group and have <code>Management Group Contributor</code> role at the group you want to move.</p>
<p>Here's the step-by-step process:</p>
<ol>
<li>Navigate to the <strong>Azure portal</strong>.</li>
<li>Go to <strong>Management groups</strong>.</li>
<li>Select the management group you want to move.</li>
<li>Click <strong>Details</strong>.</li>
<li>Under <strong>Parent group</strong>, click <strong>Change</strong>.</li>
<li>Choose the new parent group from the list and click <strong>Save</strong>.</li>
</ol>
<p>Remember, moving a management group will also move all its child resources including other management groups and subscriptions.</p>
<h3 id="moving-subscriptions"><a class="toclink" href="../../../../2024/04/23/moving-management-groups-and-subscriptions/#moving-subscriptions">Moving Subscriptions</a></h3>
<p>You can move a subscription from one management group to another or within the same management group. To do this, you must have the <code>Owner</code> or <code>Contributor</code> role at the target management group and <code>Owner</code> role at the subscription level.</p>
<p>Follow these steps:</p>
<ol>
<li>Go to the <strong>Azure portal</strong>.</li>
<li>Navigate to <strong>Management groups</strong>.</li>
<li>Select the management group where the subscription currently resides.</li>
<li>Click on <strong>Subscriptions</strong>.</li>
<li>Find the subscription you want to move and select <strong>..."</strong> (More options).</li>
<li>Click <strong>Change parent</strong>.</li>
<li>In the pop-up window, select the new parent management group and click <strong>Save</strong>.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Moving subscriptions could affect the resources if there are policies or permissions applied at the management group level. It's important to understand the implications before making the move. Also, keep in mind that you cannot move the Root management group or rename it.</p>
</div>
<p>In conclusion, moving management groups and subscriptions allows for better organization and management of your Azure resources. However, it should be done carefully considering the impact on resources and compliance with assigned policies.</p>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael FernÃ¡ndez" src="https://avatars.githubusercontent.com/u/39990341"/>
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-04-22 00:00:00">April 22, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../">Azure Services</a></li>
<li class="md-meta__item">
            
              6 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="management-groups"><a class="toclink" href="../../../../2024/04/22/management-groups/">Management Groups</a></h2>
<h3 id="what-are-management-groups"><a class="toclink" href="../../../../2024/04/22/management-groups/#what-are-management-groups">What are Management Groups?</a></h3>
<p>Management Groups are a way to manage access, policies, and compliance for multiple subscriptions. They provide a way to manage access, policies, and compliance for multiple subscriptions. Management groups are containers that help you manage access, policy, and compliance for multiple subscriptions. You organize subscriptions into containers called "management groups" and apply your governance conditions to the management groups. All subscriptions within a management group automatically inherit the conditions applied to the management group.</p>
<h3 id="management-groups-hierarchy"><a class="toclink" href="../../../../2024/04/22/management-groups/#management-groups-hierarchy">Management Groups Hierarchy</a></h3>
<p>The management group hierarchy is a level of management groups that represent the different levels of your organization. The hierarchy starts with a single root management group, which represents the Microsoft Entra ID tenant. The root management group is the highest level in the hierarchy. All other management groups are subgroups of the root management group.</p>
<h3 id="management-group-design-considerations"><a class="toclink" href="../../../../2024/04/22/management-groups/#management-group-design-considerations">Management group design considerations</a></h3>
<p>When designing your management group hierarchy, consider the following:</p>
<ul>
<li>
<p>How does your organization differentiate services that are managed or run by particular teams?</p>
</li>
<li>
<p>Are there any specific operations that need to be isolated due to business or regulatory compliance requirements?</p>
</li>
<li>
<p>Management groups can be utilized to consolidate policy and initiative assignments through Azure Policy.</p>
</li>
<li>
<p>A management group hierarchy can accommodate up to six nested levels. The tenant root level and the subscription level are not included in this count.</p>
</li>
<li>
<p>Any principal, be it a user or service principal, within a Microsoft Entra tenant has the authority to establish new management groups. This is due to the fact that Azure role-based access control (RBAC) authorization for managing group activities is not activated by default. For additional details, refer to the guide on safeguarding your resource hierarchy.</p>
</li>
<li>
<p>By default, all newly created subscriptions will be assigned to the tenant root management group.</p>
</li>
</ul>
<h3 id="management-group-recommendations"><a class="toclink" href="../../../../2024/04/22/management-groups/#management-group-recommendations">Management group recommendations</a></h3>
<ul>
<li>
<p>Maintain a relatively flat management group hierarchy, ideally with three to four levels maximum. This practice minimizes managerial complexity and overhead.</p>
</li>
<li>
<p>Refrain from mirroring your organizational structure into a deeply nested management group hierarchy. Utilize management groups primarily for policy assignment rather than billing. This strategy aligns with the Azure landing zone conceptual architecture, which applies Azure policies to workloads that need similar security and compliance at the same management group level.</p>
</li>
<li>
<p>Establish management groups under your root-level group representing different types of workloads you will host. These groups should reflect the security, compliance, connectivity, and feature requirements of the workloads. By doing this, you can apply a set of Azure policies at the management group level for all workloads with similar needs.</p>
</li>
<li>
<p>Leverage resource tags for querying and horizontally traversing across the management group hierarchy. Resource tags, enforced or appended via Azure Policy, allow you to group resources for search purposes without relying on a complex management group hierarchy.</p>
</li>
<li>
<p>Set up a top-level sandbox management group. This allows users to immediately experiment with Azure and try out resources not yet permitted in production environments. The sandbox provides isolation from your development, testing, and production settings.</p>
</li>
<li>
<p>Create a platform management group beneath the root management group to support common platform policy and Azure role assignments. This ensures distinct policies can be applied to subscriptions used for your Azure foundation and centralizes billing for common resources in one foundational subscription set.</p>
</li>
<li>
<p>Minimize the number of Azure Policy assignments made at the root management group scope. This reduces the debugging of inherited policies in lower-level management groups.</p>
</li>
<li>
<p>Implement policies to enforce compliance requirements either at the management group or subscription scope to achieve policy-driven governance.</p>
</li>
<li>
<p>Ensure only privileged users have operational access to management groups in the tenant. Enable Azure RBAC authorization in the management group <a href="https://learn.microsoft.com/en-us/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting-require-authorization">hierarchy settings</a> to fine-tune user privileges. By default, all users are authorized to create their own management groups under the root management group.</p>
</li>
<li>
<p>Set up a default, dedicated management group for new subscriptions. This prevents any subscriptions from being placed under the root management group. This is particularly important if there are users eligible for Microsoft Developer Network (MSDN) or Visual Studio benefits and subscriptions. A sandbox management group could be a suitable candidate for this type of management group. For more information, see <a href="https://learn.microsoft.com/en-us/azure/governance/management-groups/how-to/protect-resource-hierarchy#setting---default-management-group">Setting - default management group</a>.</p>
</li>
<li>
<p>Avoid creating management groups for production, testing, and development environments. If needed, separate these groups into different subscriptions within the same management group.</p>
</li>
</ul>
<h3 id="management-group-structure-in-the-enterprise-scale-landing-zone"><a class="toclink" href="../../../../2024/04/22/management-groups/#management-group-structure-in-the-enterprise-scale-landing-zone">Management Group Structure in the Enterprise Scale Landing Zone</a></h3>
<p>This is the common structure for the Management Groups in the Enterprise Scale Landing Zone: </p>
<pre class="mermaid"><code>    graph TD
        A[Root Management Group] --&gt; B[Intermediary-Management-Group]
        B --&gt; C[Decommissioned]
        B --&gt; D[Landing Zones]
        B --&gt; E[Platform]
        B --&gt; F[Sandboxes]
        D --&gt; G[Corp]
        D --&gt; H[Online]
        E --&gt; I[Connectivity]
        E --&gt; J[Identity]
        E --&gt; K[Management]
</code></pre>
<ol>
<li><strong>Root Management Group</strong><ul>
<li>Intermediary-Management-Group<ul>
<li>Decommissioned: This could be where resources that are being phased out or decommissioned are managed.</li>
<li>Sandboxes: This could be an area where developers can test and experiment without affecting production systems.</li>
<li>Landing Zones<ul>
<li>Corp: This could represent corporate resources or applications.</li>
<li>Online: This could represent online or customer-facing applications.</li>
</ul>
</li>
<li>Platform<ul>
<li>Connectivity: This could manage resources related to network connectivity.</li>
<li>Identity: This could manage resources related to identity and access management.</li>
<li>Management: This could manage resources related to overall platform management.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>This structure allows for clear segmentation of resources based on their purpose and lifecycle. For example, decommissioned resources are separated from active ones, like Sandbox, and resources within the 'Platform' are further categorized based on their function (Connectivity, Identity, Management). The 'Landing Zones' group appears to separate resources based on their use case or environment (Corp, Online).</p>
<p>The exact interpretation would depend on the specific context and conventions of your organization.</p>
<h3 id="bad-examples"><a class="toclink" href="../../../../2024/04/22/management-groups/#bad-examples">Bad Examples</a></h3>
<h4 id="example-1-deeply-nested-hierarchy"><a class="toclink" href="../../../../2024/04/22/management-groups/#example-1-deeply-nested-hierarchy">Example 1: Deeply Nested Hierarchy</a></h4>
<pre class="mermaid"><code>graph TD
    A[Root Management Group] --&gt; B[Group 1]
    B --&gt; C[Group 2]
    C --&gt; D[Group 3]
    D --&gt; E[Group 4]
    E --&gt; F[Group 5]
    F --&gt; G[Group 6]
</code></pre>
<p><strong>Why it's bad:</strong> This hierarchy is too deep. It becomes difficult to manage and increases complexity. Azure supports up to six levels of nested management groups but it's recommended to keep the hierarchy as flat as possible for simplicity.</p>
<h4 id="example-2-unorganized-structure"><a class="toclink" href="../../../../2024/04/22/management-groups/#example-2-unorganized-structure">Example 2: Unorganized Structure</a></h4>
<pre class="mermaid"><code>graph TD
    A[Root Management Group] --&gt; B[Group 1]
    A --&gt; C[Group 2]
    B --&gt; D[Group 3]
    C --&gt; E[Group 4]
    D --&gt; F[Group 5]
    E --&gt; G[Group 6]
</code></pre>
<p><strong>Why it's bad:</strong> The structure is not well-organized and doesn't follow a logical grouping or hierarchy. This can lead to confusion and difficulty in managing resources and policies.</p>
<h4 id="example-3-single-level-hierarchy"><a class="toclink" href="../../../../2024/04/22/management-groups/#example-3-single-level-hierarchy">Example 3: Single Level Hierarchy</a></h4>
<pre class="mermaid"><code>graph TD
    A[Root Management Group] --&gt; B[Group 1]
    A --&gt; C[Group 2]
    A --&gt; D[Group 3]
    A --&gt; E[Group 4]
    A --&gt; F[Group 5]
    A --&gt; G[Group 6]
</code></pre>
<p><strong>Why it's bad:</strong> Although this structure is simple, it lacks the ability to group related subscriptions together under a common management group. This makes it harder to apply consistent policies across related subscriptions.</p>
<h4 id="example-4-environment-based-hierarchy"><a class="toclink" href="../../../../2024/04/22/management-groups/#example-4-environment-based-hierarchy">Example 4: Environment-Based Hierarchy</a></h4>
<pre class="mermaid"><code>
graph TD
    A[Root Management Group] --&gt; B[Production Management Group]
    A[Root Management Group] --&gt; C[Development Management Group]
    A[Root Management Group] --&gt; D[Testing Management Group]
</code></pre>
<p><strong>Why it's bad:</strong> This structure separates environments into different management groups, which can lead to duplication of policies and increased complexity. It's better to use subscriptions within the same management group to separate environments and apply policies accordingly.</p>
<h3 id="good-examples"><a class="toclink" href="../../../../2024/04/22/management-groups/#good-examples">Good examples</a></h3>
<pre class="mermaid"><code>    graph TD
        A[Root Management Group] --&gt; B[Intermediary-Management-Group]
        B --&gt; C[Decommissioned]
        B --&gt; D[Landing Zones]
        B --&gt; E[Platform]
        B --&gt; F[Sandboxes]
        D --&gt; G[Corp]
        D --&gt; H[Online]
        E --&gt; I[Connectivity]
        E --&gt; J[Identity]
        E --&gt; K[Management]
</code></pre>
<p><img alt="ð" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/1f604.svg" title=":smile:"/></p>
<h3 id="references"><a class="toclink" href="../../../../2024/04/22/management-groups/#references">References</a></h3>
<ul>
<li>https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ready/landing-zone/design-area/resource-org-management-groups</li>
<li>https://learn.microsoft.com/en-us/azure/governance/management-groups/overview</li>
</ul>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael FernÃ¡ndez" src="https://avatars.githubusercontent.com/u/39990341"/>
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-04-19 00:00:00">April 19, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../">Azure Services</a></li>
<li class="md-meta__item">
            
              5 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="azure-network-hub-and-spoke-topology"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/">Azure Network, Hub-and-Spoke Topology</a></h2>
<p>Hub and Spoke is a network topology where a central Hub is connected to multiple Spokes. The Hub acts as a central point of connectivity and control, while the Spokes are isolated networks that connect to the Hub. This topology is common in Azure to simplify the connectivity and management of virtual networks.</p>
<pre class="mermaid"><code>graph TD
    HUB(("Central Hub"))
    SPOKE1[Spoke1]
    SPOKE2[Spoke2]
    SPOKE3[Spoke3]
    SPOKEN[Spoke...]
    HUB --- SPOKE1
    HUB --- SPOKE2
    HUB --- SPOKE3
    HUB --- SPOKEN
</code></pre>
<h3 id="key-features-of-the-hub-and-spoke-topology"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/#key-features-of-the-hub-and-spoke-topology">Key Features of the Hub and Spoke Topology</a></h3>
<ol>
<li>
<p><strong>Centralized Connectivity:</strong> The Hub centralizes the connectivity between the Spoke networks. This simplifies the administration and maintenance of the network.</p>
</li>
<li>
<p><strong>Traffic Control:</strong> The Hub acts as a traffic control point between the Spoke networks. This allows for centralized application of security and routing policies.</p>
</li>
<li>
<p><strong>Scalability:</strong> The Hub and Spoke topology is highly scalable and can grow to meet the organization's connectivity needs.</p>
</li>
<li>
<p><strong>Resilience:</strong> The Hub and Spoke topology provides redundancy and resilience in case of network failures.</p>
</li>
</ol>
<h3 id="how-to-use-the-hub-and-spoke-topology-in-azure"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/#how-to-use-the-hub-and-spoke-topology-in-azure">How to Use the Hub and Spoke Topology in Azure</a></h3>
<p>To implement the Hub and Spoke topology in Azure, follow these steps:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># Step 1: Create a virtual network for the Hub</span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>HubVnet<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--location<span class="w"> </span>eastus<span class="w"> </span>--address-prefix
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a>
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="c1"># Step 2: Create virtual networks for the Spokes</span>
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>Spoke1Vnet<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--location<span class="w"> </span>eastus<span class="w"> </span>--address-prefix
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>Spoke2Vnet<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--location<span class="w"> </span>eastus<span class="w"> </span>--address-prefix
</span><span id="__span-4-7"><a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>Spoke3Vnet<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--location<span class="w"> </span>eastus<span class="w"> </span>--address-prefix
</span><span id="__span-4-8"><a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a>
</span><span id="__span-4-9"><a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="c1"># Step 3: Connect the Spokes to the Hub</span>
</span><span id="__span-4-10"><a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>peering<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>Spoke1ToHub<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--vnet-name<span class="w"> </span>Spoke1Vnet<span class="w"> </span>--remote-vnet<span class="w"> </span>HubVnet<span class="w"> </span>--allow-vnet-access
</span><span id="__span-4-11"><a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>peering<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>Spoke2ToHub<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--vnet-name<span class="w"> </span>Spoke2Vnet<span class="w"> </span>--remote-vnet<span class="w"> </span>HubVnet<span class="w"> </span>--allow-vnet-access
</span><span id="__span-4-12"><a href="#__codelineno-4-12" id="__codelineno-4-12" name="__codelineno-4-12"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>peering<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>Spoke3ToHub<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--vnet-name<span class="w"> </span>Spoke3Vnet<span class="w"> </span>--remote-vnet<span class="w"> </span>HubVnet<span class="w"> </span>--allow-vnet-access
</span><span id="__span-4-13"><a href="#__codelineno-4-13" id="__codelineno-4-13" name="__codelineno-4-13"></a>
</span><span id="__span-4-14"><a href="#__codelineno-4-14" id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="c1"># Step 4: Configure routing between the Hub and the Spokes</span>
</span><span id="__span-4-15"><a href="#__codelineno-4-15" id="__codelineno-4-15" name="__codelineno-4-15"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>peering<span class="w"> </span>update<span class="w"> </span>--name<span class="w"> </span>Spoke1ToHub<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--vnet-name<span class="w"> </span>Spoke1Vnet<span class="w"> </span>--set<span class="w"> </span>virtualNetworkGateway:AllowGatewayTransit<span class="o">=</span><span class="nb">true</span>
</span><span id="__span-4-16"><a href="#__codelineno-4-16" id="__codelineno-4-16" name="__codelineno-4-16"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>peering<span class="w"> </span>update<span class="w"> </span>--name<span class="w"> </span>Spoke2ToHub<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--vnet-name<span class="w"> </span>Spoke2Vnet<span class="w"> </span>--set<span class="w"> </span>virtualNetworkGateway:AllowGatewayTransit<span class="o">=</span><span class="nb">true</span>
</span><span id="__span-4-17"><a href="#__codelineno-4-17" id="__codelineno-4-17" name="__codelineno-4-17"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>peering<span class="w"> </span>update<span class="w"> </span>--name<span class="w"> </span>Spoke3ToHub<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--vnet-name<span class="w"> </span>Spoke3Vnet<span class="w"> </span>--set<span class="w"> </span>virtualNetworkGateway:AllowGatewayTransit<span class="o">=</span><span class="nb">true</span>
</span><span id="__span-4-18"><a href="#__codelineno-4-18" id="__codelineno-4-18" name="__codelineno-4-18"></a>
</span><span id="__span-4-19"><a href="#__codelineno-4-19" id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="c1"># Step 5: Configure routing in the Hub</span>
</span><span id="__span-4-20"><a href="#__codelineno-4-20" id="__codelineno-4-20" name="__codelineno-4-20"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>peering<span class="w"> </span>update<span class="w"> </span>--name<span class="w"> </span>HubToSpoke1<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--vnet-name<span class="w"> </span>HubVnet<span class="w"> </span>--set<span class="w"> </span>virtualNetworkGateway:UseRemoteGateways<span class="o">=</span><span class="nb">true</span>
</span><span id="__span-4-21"><a href="#__codelineno-4-21" id="__codelineno-4-21" name="__codelineno-4-21"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>peering<span class="w"> </span>update<span class="w"> </span>--name<span class="w"> </span>HubToSpoke2<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--vnet-name<span class="w"> </span>HubVnet<span class="w"> </span>--set<span class="w"> </span>virtualNetworkGateway:UseRemoteGateways<span class="o">=</span><span class="nb">true</span>
</span><span id="__span-4-22"><a href="#__codelineno-4-22" id="__codelineno-4-22" name="__codelineno-4-22"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>peering<span class="w"> </span>update<span class="w"> </span>--name<span class="w"> </span>HubToSpoke3<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--vnet-name<span class="w"> </span>HubVnet<span class="w"> </span>--set<span class="w"> </span>virtualNetworkGateway:UseRemoteGateways<span class="o">=</span><span class="nb">true</span>
</span></code></pre></div>
<h3 id="variant-of-the-hub-and-spoke-topology"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/#variant-of-the-hub-and-spoke-topology">Variant of the Hub and Spoke Topology</a></h3>
<p>A variant of the Hub and Spoke topology is the Hub and Spoke with peering between spokes that is generally used to allow direct connectivity between the Spoke networks without going through the Hub. This can be useful in scenarios where direct connectivity between the Spoke networks is required, such as data replication or application communication.</p>
<p><pre class="mermaid"><code>graph TD
    HUB(("Central Hub"))
    SPOKE1[Spoke1]
    SPOKE2[Spoke2]
    SPOKE3[Spoke3]
    SPOKEN[Spoke...]
    HUB --- SPOKE1
    HUB --- SPOKE2
    HUB --- SPOKE3
    HUB --- SPOKEN
    SPOKE1 -.- SPOKE2    
</code></pre>
In this case, it would be connecting the Spoke networks to each other via virtual network peering, for example:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="c1"># Connect Spoke1 to Spoke2</span>
</span><span id="__span-5-2"><a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a>az<span class="w"> </span>network<span class="w"> </span>vnet<span class="w"> </span>peering<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span>Spoke1ToSpoke2<span class="w"> </span>--resource-group<span class="w"> </span>MyResourceGroup<span class="w"> </span>--vnet-name<span class="w"> </span>Spoke1Vnet<span class="w"> </span>--remote-vnet<span class="w"> </span>Spoke2Vnet<span class="w"> </span>--allow-vnet-access
</span></code></pre></div>
<h3 id="scalability-and-performance"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/#scalability-and-performance">Scalability and Performance</a></h3>
<p>The Hub and Spoke topology in Azure is highly scalable and can handle thousands of virtual networks and subnets. In terms of performance, the Hub and Spoke topology provides efficient and low-latency connectivity between the Spoke networks and the Hub.</p>
<h3 id="security-and-compliance"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/#security-and-compliance">Security and Compliance</a></h3>
<p>The Hub and Spoke topology in Azure provides centralized control over network security and compliance. Security and routing policies can be applied centrally at the Hub, ensuring consistency and compliance with the organization's network policies.</p>
<h3 id="monitoring-and-logging"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/#monitoring-and-logging">Monitoring and Logging</a></h3>
<p>Use Network Watcher to monitor and diagnose network problems in the Hub and Spoke topology. Network Watcher provides the following tools: </p>
<ul>
<li>Monitoring<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/view-network-topology">Topology view</a> shows you the resources in your virtual network and the relationships between them.</li>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/connection-monitor-overview">Connection monitor</a> allows you to monitor connectivity and latency between endpoints within and outside of Azure.</li>
</ul>
</li>
<li>Network diagnostic tools<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-ip-flow-verify-overview">IP flow verify</a> helps you detect traffic filtering issues at the virtual machine level.</li>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-network-configuration-diagnostics-overview">NSG diagnostics</a> helps you detect traffic filtering issues at the virtual machine, virtual machine scale set, or application gateway level.</li>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-next-hop-overview">Next hop</a> helps you verify traffic routes and detect routing issues.</li>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-connectivity-portal">Connection troubleshoot</a> enables a one-time check of connectivity and latency between a virtual machine and the Bastion host, application gateway, or another virtual machine.</li>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-packet-capture-overview">Packet capture</a> allows you to capture traffic from your virtual machine.</li>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-troubleshoot-overview">VPN troubleshoot</a> runs multiple diagnostic checks on your gateways and VPN connections to help debug issues.</li>
</ul>
</li>
<li>Traffic<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-overview">Network security group flow logs</a> and <a href="https://docs.microsoft.com/en-us/azure/network-watcher/vnet-flow-logs-overview">virtual network flow logs</a> let you log network traffic passing through your network security groups (NSGs) and virtual networks respectively.</li>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/traffic-analytics">Traffic analytics</a> processes data from your network security group flow log allowing you to visualize, query, analyze, and understand your network traffic.</li>
</ul>
</li>
</ul>
<p>Virtual network flow logs have recently been released which allows for monitoring network traffic in Azure virtual networks.</p>
<h3 id="use-cases-and-examples"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/#use-cases-and-examples">Use Cases and Examples</a></h3>
<p>The Hub and Spoke topology is ideal for organizations that require centralized connectivity and traffic control between multiple virtual networks in Azure. For example, an organization with multiple branches or departments can use the Hub and Spoke topology to securely and efficiently connect their virtual networks in the cloud.</p>
<h3 id="best-practices-and-tips"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/#best-practices-and-tips">Best Practices and Tips</a></h3>
<p>When implementing the Hub and Spoke topology in Azure, it is recommended to follow these best practices:</p>
<ul>
<li><strong>Security:</strong> Apply consistent security policies at the Hub and Spokes to ensure network protection.</li>
<li><strong>Resilience:</strong> Configure redundancy and resilience in the topology to ensure network availability in case of failures.</li>
<li><strong>Monitoring:</strong> Use monitoring tools like Azure Monitor to monitor network traffic and detect potential performance issues.</li>
</ul>
<h3 id="conclusion"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/#conclusion">Conclusion</a></h3>
<p>The Hub and Spoke topology is an effective way to simplify the connectivity and management of virtual networks in Azure. It provides centralized control over network connectivity and traffic, making it easier to implement security and routing policies consistently across the network. By following the recommended best practices and tips, organizations can make the most of the Hub and Spoke topology to meet their cloud connectivity needs.</p>
<h3 id="references"><a class="toclink" href="../../../../2024/04/19/azure-network-hub-and-spoke-topology/#references">References</a></h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/network-watcher/frequently-asked-questions">Network Watcher frequently asked questions (FAQ)</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/architecture/reference-architectures/hybrid-networking/hub-spoke">Azure Topology</a></li>
</ul>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael FernÃ¡ndez" src="https://avatars.githubusercontent.com/u/39990341"/>
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-04-18 00:00:00">April 18, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../">Azure Services</a></li>
<li class="md-meta__item">
            
              3 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="kusto-query-language-kql-for-azure-resource-graph"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/">Kusto Query Language (KQL) for Azure Resource Graph</a></h2>
<p>Azure Graph is a powerful tool provided by Microsoft to query data across all your Azure resources. It uses the Kusto Query Language (KQL), a read-only language similar to SQL, designed to query vast amounts of data in Azure services.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Only a subset of KQL is supported in Azure Resource Graph. For more information, see the <a href="https://learn.microsoft.com/en-us/azure/governance/resource-graph/concepts/query-language#supported-kql-language-elements">Azure Resource Graph Supported KQL Language Elements</a>.</p>
</div>
<h3 id="what-is-kql"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#what-is-kql"><strong>What is KQL?</strong></a></h3>
<p>KQL stands for Kusto Query Language. It's a request to process data and return results. The syntax is easy to read and author, making it ideal for data exploration and ad-hoc data mining tasks.</p>
<h3 id="using-kql-with-azure-graph"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#using-kql-with-azure-graph"><strong>Using KQL with Azure Graph</strong></a></h3>
<p>Azure Graph allows you to use KQL to create complex queries that fetch information from your Azure resources. You can filter, sort, aggregate, and join data from different resources using KQL.</p>
<p>Here's an example of how you might use KQL to query Azure Graph:</p>
<div class="language-kql highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="n">Resources</span>
</span><span id="__span-12-2"><a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">'microsoft.web/sites'</span>
</span><span id="__span-12-3"><a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="p">|</span><span class="w"> </span><span class="k">project</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">resourceGroup</span>
</span></code></pre></div>
<p>This query retrieves all Azure Web Apps (websites) and projects their <code>name</code>, <code>location</code>, and <code>resourceGroup</code>.</p>
<h3 id="key-characteristics-of-kql"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#key-characteristics-of-kql"><strong>Key Characteristics of KQL</strong></a></h3>
<ol>
<li><strong>Case Sensitivity</strong>: Unlike SQL, KQL is case-sensitive. So 'Name' and 'name' would be considered different identifiers.</li>
<li><strong>Schema-Free</strong>: Kusto (Azure Data Explorer) doesn't require a fixed schema, allowing storage of diverse types of data.</li>
<li><strong>Extensibility</strong>: While KQL has a wide array of functions, you can also create custom functions as per your needs.</li>
</ol>
<h3 id="common-operators-in-kql"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#common-operators-in-kql"><strong>Common Operators in KQL</strong></a></h3>
<ul>
<li><code>|</code> : This operator creates a pipeline where the output of one command becomes the input of another.</li>
<li><code>where</code> : Filters rows based on specified conditions.</li>
<li><code>summarize</code> : Groups rows and calculates aggregate expressions.</li>
<li><code>join</code> : Combines rows from two tables based on a common column.</li>
<li><code>project</code> : Selects specific columns from the input.</li>
<li><code>extend</code> : Adds new columns to the input.</li>
<li><code>order by</code> : Sorts rows based on specified columns.</li>
</ul>
<h3 id="kql-query-examples"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#kql-query-examples"><strong>KQL Query Examples</strong></a></h3>
<h4 id="1-list-all-azure-resources-in-a-subscription"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#1-list-all-azure-resources-in-a-subscription"><strong>1. List all Azure resources in a subscription</strong></a></h4>
<div class="language-kql highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">Resources</span>
</span></code></pre></div>
<h4 id="2-list-all-azure-resources-in-a-resource-group"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#2-list-all-azure-resources-in-a-resource-group"><strong>2. List all Azure resources in a resource group</strong></a></h4>
<div class="language-kql highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">Resources</span>
</span><span id="__span-14-2"><a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">resourceGroup</span><span class="w"> </span><span class="p">==</span><span class="w"> </span><span class="s">'myResourceGroup'</span>
</span></code></pre></div>
<h4 id="3-list-all-azure-resources-of-a-specific-type"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#3-list-all-azure-resources-of-a-specific-type"><strong>3. List all Azure resources of a specific type</strong></a></h4>
<div class="language-kql highlight"><pre><span></span><code><span id="__span-15-1"><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">Resources</span>
</span><span id="__span-15-2"><a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="p">|</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">=~</span><span class="w"> </span><span class="s">'Microsoft.Compute/virtualMachines'</span>
</span></code></pre></div>
<h3 id="pagination-in-kql"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#pagination-in-kql"><strong>Pagination in KQL</strong></a></h3>
<p>KQL supports pagination using the <code>limit</code> and <code>offset</code> operators. You can use these operators to control the number of rows returned and skip a certain number of rows.</p>
<div class="language-kql highlight"><pre><span></span><code><span id="__span-16-1"><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">Resources</span>
</span><span id="__span-16-2"><a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="p">|</span><span class="w"> </span><span class="k">limit</span><span class="w"> </span><span class="mi">10</span>
</span><span id="__span-16-3"><a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="p">|</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="mi">5</span>
</span></code></pre></div>
<p>If you exceed payload limits, you can paginate Azure Resource Graph query results with powershell:</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-17-1"><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="nv">$kqlQuery</span> <span class="p">=</span> <span class="s2">"policyResources | where type =~'Microsoft.Authorization/PolicySetDefinitions' or type =~'Microsoft.Authorization/PolicyDefinitions' | project definitionId = tolower(id), category = tostring(properties.metadata.category), definitionType = iff(type =~ 'Microsoft.Authorization/PolicysetDefinitions', 'initiative', 'policy'),PolicyDefinition=properties"</span>
</span><span id="__span-17-2"><a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a>
</span><span id="__span-17-3"><a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="nv">$batchSize</span> <span class="p">=</span> <span class="n">5</span>
</span><span id="__span-17-4"><a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="nv">$skipResult</span> <span class="p">=</span> <span class="n">0</span>
</span><span id="__span-17-5"><a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a>
</span><span id="__span-17-6"><a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="no">[System.Collections.Generic.List[string]]</span><span class="nv">$kqlResult</span>
</span><span id="__span-17-7"><a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a>
</span><span id="__span-17-8"><a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="k">while</span> <span class="p">(</span><span class="nv">$true</span><span class="p">)</span> <span class="p">{</span>
</span><span id="__span-17-9"><a href="#__codelineno-17-9" id="__codelineno-17-9" name="__codelineno-17-9"></a>
</span><span id="__span-17-10"><a href="#__codelineno-17-10" id="__codelineno-17-10" name="__codelineno-17-10"></a>  <span class="k">if</span> <span class="p">(</span><span class="nv">$skipResult</span> <span class="o">-gt</span> <span class="n">0</span><span class="p">)</span> <span class="p">{</span>
</span><span id="__span-17-11"><a href="#__codelineno-17-11" id="__codelineno-17-11" name="__codelineno-17-11"></a>    <span class="nv">$graphResult</span> <span class="p">=</span> <span class="nb">Search-AzGraph</span> <span class="n">-Query</span> <span class="nv">$kqlQuery</span> <span class="n">-First</span> <span class="nv">$batchSize</span> <span class="n">-SkipToken</span> <span class="nv">$graphResult</span><span class="p">.</span><span class="n">SkipToken</span>
</span><span id="__span-17-12"><a href="#__codelineno-17-12" id="__codelineno-17-12" name="__codelineno-17-12"></a>  <span class="p">}</span>
</span><span id="__span-17-13"><a href="#__codelineno-17-13" id="__codelineno-17-13" name="__codelineno-17-13"></a>  <span class="k">else</span> <span class="p">{</span>
</span><span id="__span-17-14"><a href="#__codelineno-17-14" id="__codelineno-17-14" name="__codelineno-17-14"></a>    <span class="nv">$graphResult</span> <span class="p">=</span> <span class="nb">Search-AzGraph</span> <span class="n">-Query</span> <span class="nv">$kqlQuery</span> <span class="n">-First</span> <span class="nv">$batchSize</span>
</span><span id="__span-17-15"><a href="#__codelineno-17-15" id="__codelineno-17-15" name="__codelineno-17-15"></a>  <span class="p">}</span>
</span><span id="__span-17-16"><a href="#__codelineno-17-16" id="__codelineno-17-16" name="__codelineno-17-16"></a>
</span><span id="__span-17-17"><a href="#__codelineno-17-17" id="__codelineno-17-17" name="__codelineno-17-17"></a>  <span class="nv">$kqlResult</span> <span class="p">+=</span> <span class="nv">$graphResult</span><span class="p">.</span><span class="n">data</span>
</span><span id="__span-17-18"><a href="#__codelineno-17-18" id="__codelineno-17-18" name="__codelineno-17-18"></a>
</span><span id="__span-17-19"><a href="#__codelineno-17-19" id="__codelineno-17-19" name="__codelineno-17-19"></a>  <span class="k">if</span> <span class="p">(</span><span class="nv">$graphResult</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">Count</span> <span class="o">-lt</span> <span class="nv">$batchSize</span><span class="p">)</span> <span class="p">{</span>
</span><span id="__span-17-20"><a href="#__codelineno-17-20" id="__codelineno-17-20" name="__codelineno-17-20"></a>    <span class="k">break</span><span class="p">;</span>
</span><span id="__span-17-21"><a href="#__codelineno-17-21" id="__codelineno-17-21" name="__codelineno-17-21"></a>  <span class="p">}</span>
</span><span id="__span-17-22"><a href="#__codelineno-17-22" id="__codelineno-17-22" name="__codelineno-17-22"></a>  <span class="nv">$skipResult</span> <span class="p">+=</span> <span class="nv">$skipResult</span> <span class="p">+</span> <span class="nv">$batchSize</span>
</span><span id="__span-17-23"><a href="#__codelineno-17-23" id="__codelineno-17-23" name="__codelineno-17-23"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="best-practices-for-writing-kql-queries"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#best-practices-for-writing-kql-queries"><strong>Best Practices for Writing KQL Queries</strong></a></h3>
<ol>
<li><strong>Use <code>project</code> to Select Columns</strong>: Only select the columns you need to reduce the amount of data returned.</li>
<li><strong>Use <code>where</code> to Filter Rows</strong>: Apply filters to reduce the number of rows processed.</li>
<li><strong>Use <code>summarize</code> to Aggregate Data</strong>: Aggregate data to reduce the number of rows returned.</li>
<li><strong>Use <code>join</code> to Combine Data</strong>: Combine data from different tables using the <code>join</code> operator.</li>
<li><strong>Use <code>order by</code> to Sort Data</strong>: Sort data based on specific columns to make it easier to read.</li>
</ol>
<h3 id="limitations-of-kql"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#limitations-of-kql"><strong>Limitations of KQL</strong></a></h3>
<ol>
<li><strong>No DDL Operations</strong>: KQL doesn't support Data Definition Language (DDL) operations like creating tables or indexes.</li>
<li><strong>No DML Operations</strong>: KQL doesn't support Data Manipulation Language (DML) operations like inserting, updating, or deleting data.</li>
<li><strong>Limited Data Types</strong>: KQL has a limited set of data types compared to SQL.</li>
<li><strong>No Transactions</strong>: KQL doesn't support transactions, so you can't group multiple operations into a single transaction.</li>
</ol>
<h3 id="conclusion"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#conclusion"><strong>Conclusion</strong></a></h3>
<p>KQL is a potent tool for querying large datasets in Azure. Its SQL-like syntax makes it accessible for anyone familiar with SQL, and its rich set of features makes it a flexible solution for a variety of data processing needs. Practice writing KQL queries to uncover valuable insights from your Azure resources!</p>
<h3 id="references"><a class="toclink" href="../../../../2024/04/18/kusto-query-language-kql-for-azure-resource-graph/#references">References</a></h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/data-explorer/kusto/query/sqlcheatsheet">SQL to Kusto Query Language cheat sheet</a></li>
<li><a href="https://portal.azure.com/#view/Microsoft_OperationsManagementSuite_Workspace/LogsDemo.ReactView">Demo for play</a></li>
</ul>
</div>
</article>
<article class="md-post md-post--excerpt">
<header class="md-post__header">
<nav class="md-post__authors md-typeset">
<span class="md-author">
<img alt="Rafael FernÃ¡ndez" src="https://avatars.githubusercontent.com/u/39990341"/>
</span>
</nav>
<div class="md-post__meta md-meta">
<ul class="md-meta__list">
<li class="md-meta__item">
<time datetime="2024-04-17 00:00:00">April 17, 2024</time></li>
<li class="md-meta__item">
            in
            
              <a class="md-meta__link" href="../../">Azure Services</a></li>
<li class="md-meta__item">
            
              1 min read
            
          </li>
</ul>
</div>
</header>
<div class="md-post__content md-typeset">
<h2 id="cambio-de-nombres-de-los-niveles-de-servicio-de-microsoft-defender-para-cloud"><a class="toclink" href="../../../../2024/04/17/cambio-de-nombres-de-los-niveles-de-servicio-de-microsoft-defender-para-cloud/">Cambio de nombres de los niveles de servicio de Microsoft Defender para Cloud</a></h2>
<p>No es nuevo pero me gustarÃ­a recordar que Microsoft ha cambiado los nombres de los niveles de servicio de Microsoft Defender para Cloud. A continuaciÃ³n, se muestra una tabla con los nombres anteriores y los nuevos nombres de los niveles de servicio de Microsoft Defender para Cloud:</p>
<table>
<thead>
<tr>
<th>Nombre ANTERIOR del nivel de servicioÂ 2</th>
<th>Nombre NUEVO del nivel de servicioÂ 2</th>
<th>Nivel de servicio: nivel de servicioÂ 4 (sin cambios)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Advanced Data Security</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para SQL</td>
</tr>
<tr>
<td>Advanced Threat Protection</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para registros de contenedor</td>
</tr>
<tr>
<td>Advanced Threat Protection</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para DNS</td>
</tr>
<tr>
<td>Advanced Threat Protection</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para Key Vault</td>
</tr>
<tr>
<td>Advanced Threat Protection</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para Kubernetes</td>
</tr>
<tr>
<td>Advanced Threat Protection</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para MySQL</td>
</tr>
<tr>
<td>Advanced Threat Protection</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para PostgreSQL</td>
</tr>
<tr>
<td>Advanced Threat Protection</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para Resource Manager</td>
</tr>
<tr>
<td>Advanced Threat Protection</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para Storage</td>
</tr>
<tr>
<td>Azure Defender</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>AdministraciÃ³n de superficie expuesta a ataques externos de Defender</td>
</tr>
<tr>
<td>Azure Defender</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para Azure CosmosÂ DB</td>
</tr>
<tr>
<td>Azure Defender</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para contenedores</td>
</tr>
<tr>
<td>Azure Defender</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender for MariaDB</td>
</tr>
<tr>
<td>Security Center</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para App Service</td>
</tr>
<tr>
<td>Security Center</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>Defender para servidores</td>
</tr>
<tr>
<td>Security Center</td>
<td>MicrosoftÂ DefenderÂ forÂ Cloud</td>
<td>AdministraciÃ³n de la posiciÃ³n de seguridad en la nube de Defender</td>
</tr>
</tbody>
</table>
</div>
</article>
<nav class="md-pagination">
<a class="md-pagination__link" href="../../">1</a> <span class="md-pagination__current">2</span> <a class="md-pagination__link" href="../3/">3</a> <a class="md-pagination__link" href="../4/">4</a>
</nav>
</div>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright Â© 2023-now Rafael FernÃ¡ndez
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://www.linkedin.com/in/rafaelfernandezd/" rel="noopener" target="_blank" title="LinkedIn">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"></path></svg>
</a>
<a class="md-social__link" href="https://github.com/rfernandezdo" rel="noopener" target="_blank" title="GitHub">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://rfernandezdo.github.io/feed_rss_created.xml" rel="noopener" target="_blank" title="RSS feed">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64zm32 104c0-13.3 10.7-24 24-24 137 0 248 111 248 248 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200-13.3 0-24-10.7-24-24m0 96c0-13.3 10.7-24 24-24 83.9 0 152 68.1 152 152 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104-13.3 0-24-10.7-24-24m0 120a32 32 0 1 1 64 0 32 32 0 1 1-64 0"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-progress" data-md-component="progress" role="progressbar"></div>
<script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "navigation.sections", "navigation.top", "navigation.tracking", "toc.integrate", "toc.nested", "toc.smoothscroll", "footer", "content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips"], "search": "../../../../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../../../assets/javascripts/bundle.56dfad97.min.js"></script>
<script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
<script src="../../../../../javascripts/tablesort.js"></script>
<script type="module">import mermaid from "https://unpkg.com/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.mermaidConfig = {default: {
    startOnLoad: false
}};</script><script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>